var MapCamera=pc.createScript("mapCamera");MapCamera.prototype.initialize=function(){},MapCamera.prototype.update=function(a){if(this.app.root.findByName("TrackCamera").enabled)var t=this.app.root.findByName("TrackCamera").findByName("Camera").getPosition();else t=this.app.root.findByName("WalkPlayer").getPosition();var e=this.entity.getPosition();const i=this.app.root.findByTag("floorPlan").map((a=>a.getPosition().y)),r=i.map((a=>t.y-a-.7));let o=0,p=r.length-1;for(;o=r[p],!(o>=0);){if(p<=0){p=0;break}p--}this.entity.camera.nearClip=Math.floor(e.y-i[p]),this.entity.camera.farClip=Math.ceil(e.y-i[p])};var Trigger=pc.createScript("trigger");Trigger.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.entity.collision.on("triggerleave",this.onTriggerLeave,this)},Trigger.prototype.onTriggerEnter=function(){this.app.root.findByName("EV_GetIn").enabled=!0},Trigger.prototype.onTriggerLeave=function(){this.app.root.findByName("EV_GetIn").enabled=!1};var meta=document.querySelector("meta[name=viewport]");meta.setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover");var Controllers=pc.createScript("controllers");Controllers.attributes.add("controllerTemplate",{type:"asset",assetType:"template",title:"Controller Template"}),Controllers.prototype.initialize=function(){this.controllerAssets=this.app.assets.findByTag("controller"),this.controllerAssetsIndex={};for(var e=0;e<this.controllerAssets.length;e++){var t=this.controllerAssets[e].name.replace(/\.[a-z]+$/i,"");this.controllerAssetsIndex[t]=this.controllerAssets[e]}this.app.xr.input.on("add",(function(e){var t=this.controllerTemplate.resource.instantiate(),r=this.app.root.findByName("Right_Con").clone();r.reparent(this.app.root);var s=this.app.root.findByName("Left_Con").clone();s.reparent(this.app.root);for(var o=null,n=0;n<e.profiles.length;n++){var l=e.profiles[n]+"-"+e.handedness;if(o=this.controllerAssetsIndex[l])break}o||(o=this.controllerAssetsIndex["generic-trigger-"+(e.handedness||"none")]),e.handedness==pc.XRHAND_RIGHT?(r.script.controller.setInputSource(e,o),r.enabled=!0):e.handedness==pc.XRHAND_LEFT?(s.script.controller.setInputSource(e,o),s.enabled=!0):(t.script.controller.setInputSource(e,o),t.enabled=!0)}),this)};var AutoExposure=pc.createScript("autoExposure");AutoExposure.attributes.add("targetExposure",{type:"number",default:2});var LERP_SPEED=1;this.oncollision=0,AutoExposure.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},AutoExposure.prototype.onTriggerEnter=function(){this.app.fire("PhaseMover:phase",e=this.targetExposure)},AutoExposure.prototype.update=function(t){};var LookCamera=pc.createScript("lookCamera");LookCamera.attributes.add("mouseSensivity",{title:"Mouse Sensivity",type:"number",default:.3}),LookCamera.attributes.add("controllerTemplate",{title:"Controller Template",type:"asset",assetType:"template"}),LookCamera.prototype.initialize=function(){this._offsetParent=this.entity.parent;var t=this.entity.getRotation();this.yaw=pc.util.getYaw(t),this.pitch=this._getPitch(t,this.yaw),this.movedMouse=0,this.movedStart=0,this.touchCoords=new pc.Vec2,this.app.mouse.on(pc.EVENT_MOUSEDOWN,this._onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this._onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this._onMouseMove,this),this.app.mouse.disableContextMenu(),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this._onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHEND,this._onTouchEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this._onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this._onTouchMove,this)),this.app.mainCamera=this.entity,this.gazeController=null,this.app.xr.active||(this.gazeController=this.controllerTemplate.resource.instantiate(),this.gazeController.reparent(this.app.root),this.gazeController.enabled=!0),this.app.xr.on("start",(function(){this.gazeController&&(this.gazeController.destroy(),this.gazeController=null)}),this),this.app.xr.on("end",(function(){this.gazeController||(this.gazeController=this.controllerTemplate.resource.instantiate(),this.gazeController.reparent(this.app.root),this.gazeController.enabled=!0)}),this)},LookCamera.prototype._onMouseDown=function(t){this.app.xr.active||t.button===pc.MOUSEBUTTON_LEFT&&(this.movedStart=Date.now(),this.movedMouse=0,this.gazeController&&this.gazeController.script.controller.onSelectStart())},LookCamera.prototype._onTouchStart=function(t){this.app.xr.active||(t.event.preventDefault(),1===t.touches.length&&(this.movedStart=Date.now(),this.movedMouse=0,this.touchCoords.set(t.touches[0].x,t.touches[0].y),this.gazeController&&(this.gazeController.script.controller.active=!0,this.gazeController.script.controller.mouseCoords.set(t.touches[0].x,t.touches[0].y),this.gazeController.script.controller.onSelectStart())))},LookCamera.prototype._onMouseUp=function(t){this.app.xr.active||t.button===pc.MOUSEBUTTON_LEFT&&this.gazeController&&(!pc.Mouse.isPointerLocked()&&(this.movedMouse>30||Date.now()-this.movedStart>300)&&(this.gazeController.script.controller.teleportable=!1),this.gazeController.script.controller.onSelectEnd(),this.gazeController.script.controller.teleportable=!0)},LookCamera.prototype._onTouchEndCancel=function(t){this.app.xr.active||0===t.touches.length&&this.gazeController&&((this.movedMouse>30||Date.now()-this.movedStart>300)&&(this.gazeController.script.controller.teleportable=!1),this.gazeController.script.controller.onSelectEnd(),this.gazeController.script.controller.teleportable=!0,this.gazeController.script.controller.active=!1)},LookCamera.prototype._onMouseMove=function(t){this.app.xr.active||(this.gazeController&&(this.gazeController.script.controller.mouseCoords.set(t.x,t.y),this.gazeController.script.controller.active=!0),!pc.Mouse.isPointerLocked()&&(!this.app.mouse.isPressed(pc.MOUSEBUTTON_LEFT)||this.gazeController&&this.gazeController.script.controller.getHeldEntity())||(this.pitch=Math.max(-90,Math.min(90,this.pitch-t.dy*this.mouseSensivity)),this.yaw-=t.dx*this.mouseSensivity,this.movedMouse+=Math.abs(t.dy)+Math.abs(t.dx)))},LookCamera.prototype._onTouchMove=function(t){if(!this.app.xr.active&&1===t.touches.length&&(this.gazeController&&this.gazeController.script.controller.mouseCoords.set(t.touches[0].x,t.touches[0].y),!this.gazeController||!this.gazeController.script.controller.getHeldEntity())){var o=t.touches[0].x-this.touchCoords.x,e=t.touches[0].y-this.touchCoords.y;this.touchCoords.set(t.touches[0].x,t.touches[0].y),this.pitch=Math.max(-90,Math.min(90,this.pitch-e*this.mouseSensivity)),this.yaw-=o*this.mouseSensivity,this.movedMouse+=Math.abs(e)+Math.abs(o)}},LookCamera.prototype.update=function(t){this._offsetParent.setLocalEulerAngles(0,this.yaw,0),this.app.xr.active||this.entity.setLocalEulerAngles(this.pitch,0,0)},LookCamera.quatWithoutYaw=new pc.Quat,LookCamera.yawOffset=new pc.Quat,LookCamera.prototype._getPitch=function(t,o){var e=LookCamera.quatWithoutYaw,s=LookCamera.yawOffset;s.setFromEulerAngles(0,-o,0),e.mul2(s,t);var r=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,r),Math.atan2(r.y,-r.z)*pc.math.RAD_TO_DEG};var EvVrButton=pc.createScript("evVrButton");EvVrButton.attributes.add("blinkMultiplier",{type:"number",default:2}),EvVrButton.attributes.add("originalScale",{type:"number",default:.001}),EvVrButton.attributes.add("scaleFactor",{type:"number",default:.001}),EvVrButton.prototype.initialize=function(){this._time=0},EvVrButton.prototype.update=function(t){this._time+=this.blinkMultiplier*t;var i=(Math.sin(this._time)+1)/2*this.scaleFactor;console.log(i),this.entity.setLocalScale(this.originalScale+i,this.originalScale+i,this.originalScale+i)};var Ui=pc.createScript("ui");Ui.attributes.add("html",{type:"asset",assetType:"html"}),Ui.attributes.add("css",{type:"asset",assetType:"css"}),Ui.prototype.initialize=function(){this.fixedHtml="",this.fixedCss="",this.fixUp(),this.createCss(),this.createHtml(),this.initUi()},Ui.prototype.fixUp=function(){this.fixedHtml=this.html.resource,this.fixedCss=this.css.resource,this.app.assets.findByTag("ui").forEach(function(t){var e=new RegExp(t.name,"gi"),i=t.getFileUrl();this.fixedHtml=this.fixedHtml.replace(e,i),this.fixedCss=this.fixedCss.replace(e,i)}.bind(this))},Ui.prototype.createCss=function(){var t=document.createElement("style");t.type="text/css",t.innerHTML=this.fixedCss,this.css.on("load",(function(){this.fixUp(),t.innerHTML=this.fixedCss}),this),document.getElementsByTagName("head")[0].appendChild(t)},Ui.prototype.createHtml=function(){var t=document.createElement("div");t.innerHTML=this.fixedHtml,this.html.on("load",(function(){this.fixUp(),t.innerHTML=this.fixedHtml,this.initUi()}),this),document.body.appendChild(t)},Ui.prototype.initUi=function(){var t=this.app;["fullscreen-button"].forEach((function(t){el=document.getElementById(t),el.addEventListener("mousedown",(function(t){t.stopPropagation()})),el.addEventListener("touchstart",(function(t){t.stopPropagation()}))})),["vr-button"].forEach((function(t){el=document.getElementById(t),el.addEventListener("mousedown",(function(t){t.stopPropagation()})),el.addEventListener("touchstart",(function(t){t.stopPropagation()}))})),el=document.getElementById("fullscreen-button"),document.documentElement.requestFullscreen?el.addEventListener("click",(function(t){el.classList.contains("checked")?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen(),el.classList.toggle("checked")})):el.classList.add("hidden"),el=document.getElementById("vr-button"),el.addEventListener("click",(function(e){Vrstate=t.root.findByName("VrState"),Vrstate.enabled=!Vrstate.enabled,t.xr&&!t.xr.active&&t.xr.isAvailable(pc.XRTYPE_VR)&&(t.root.findByName("A_PC_Mobile").enabled=!1,t.root.findByName("B_VR").enabled=!0,Vrstate.script.vr.sessionStart())}))};var Vr=pc.createScript("vr");Vr.attributes.add("elementUnsupported",{type:"entity",title:"Unsupported Message"}),Vr.attributes.add("elementUnavailable",{type:"entity",title:"Unavailable Message"}),Vr.attributes.add("elementHttpsRequired",{type:"entity",title:"HTTPS Required Message"}),Vr.attributes.add("cameraEntity",{type:"entity",title:"Camera"}),Vr.prototype.initialize=function(){this.app.keyboard.on("keydown",(function(e){e.key===pc.KEY_ESCAPE&&this.app.xr.active&&this.app.xr.end()}),this),this.errorMessage(),this.app.xr.on("end",(function(){this.app.root.findByName("A_PC_Mobile").enabled=!0,this.app.root.findByName("B_VR").enabled=!1,this.app.scene.exposure=1}))},Vr.prototype.errorMessage=function(){if(this.app.xr.supported){if(this.elementHttpsRequired.enabled=!1,this.elementUnsupported.enabled=!1,this.elementUnavailable.enabled=!1,!this.app.xr.active)var e=this.app.xr&&!this.app.xr.active&&this.app.xr.isAvailable(pc.XRTYPE_VR);e||(this.elementUnavailable.enabled=!0)}else this.elementUnavailable.enabled=!1,"https:"==window.location.protocol?(this.elementUnsupported.enabled=!0,this.elementHttpsRequired.enabled=!1):(this.elementUnsupported.enabled=!1,this.elementHttpsRequired.enabled=!0)},Vr.prototype.sessionStart=function(){this.app.xr.supported&&(this.app.xr.active||this.app.xr.isAvailable(pc.XRTYPE_VR)&&(window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(e){"granted"===e&&window.addEventListener("deviceorientation",function(e){this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCALFLOOR)}.bind(this))}.bind(this)).catch(console.error):this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCALFLOOR)))};var Teleport=pc.createScript("teleport");Teleport.prototype.initialize=function(){this.app.on("teleport:show",(function(){this.entity.enabled=!0}),this),this.app.on("teleport:hide",(function(){this.entity.enabled=!1}),this),this.app.on("teleport:transform",(function(t,e){this.entity.setPosition(t),this.entity.setRotation(e)}),this)};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){var t=this,onWindowResize=function(){t._checkAspectRatio()};window.addEventListener("resize",onWindowResize,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var i=this.entity.getRotation();if(this._yaw=this._calcYaw(i),this._pitch=this._clampPitchAngle(this._calcPitch(i,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var e=new pc.Vec3;e.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(e.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:distanceMax",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:pitchAngleMin",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:pitchAngleMax",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:focusEntity",(function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)})),this.on("attr:frameOnStart",(function(t,i){t&&this.focus(this.focusEntity||this.app.root)})),this.on("destroy",(function(){window.removeEventListener("resize",onWindowResize,!1)}))},OrbitCamera.prototype.update=function(t){var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t,i){var e=0;if(t.model){var a=t.model.meshInstances;for(e=0;e<a.length;e++)0===i?this._modelsAabb.copy(a[e].aabb):this._modelsAabb.add(a[e].aabb),i+=1}for(e=0;e<t.children.length;++e)i+=this._buildAabb(t.children[e],i);return i},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};!function(){var t=new pc.Vec3;pc.RigidBodyComponentSystem.prototype.raycastFirstByTag=function(n,r,a){for(var e=Number.MAX_VALUE,i=null,s=this.app.systems.rigidbody.raycastAll(n,r),o=0;o<s.length;++o){var y=s[o];if(y.entity.tags.has(a)){t.sub2(y.point,n);var p=t.lengthSq();p<e&&(e=p,i=y)}}return i}}();var TouchInputFly=pc.createScript("TouchInputFly");TouchInputFly.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInputFly.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInputFly.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",(function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)})))},TouchInputFly.prototype.getPinchDistance=function(t,i){var o=t.x-i.x,n=t.y-i.y;return Math.sqrt(o*o+n*n)},TouchInputFly.prototype.calcMidPoint=function(t,i,o){o.set(i.x-t.x,i.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y},TouchInputFly.prototype.onTouchStartEndCancel=function(t){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))},TouchInputFly.fromWorldPoint=new pc.Vec3,TouchInputFly.toWorldPoint=new pc.Vec3,TouchInputFly.worldDiff=new pc.Vec3,TouchInputFly.prototype.pan=function(t){var i=TouchInputFly.fromWorldPoint,o=TouchInputFly.toWorldPoint,n=TouchInputFly.worldDiff,h=this.entity.camera,c=this.orbitCamera.distance;h.screenToWorld(t.x,t.y,c,i),h.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,c,o),n.sub2(o,i),this.orbitCamera.pivotPoint.add(n)},TouchInputFly.pinchMidPoint=new pc.Vec2,TouchInputFly.prototype.onTouchMove=function(t){var i=TouchInputFly.pinchMidPoint,o=t.touches;if(1==o.length){var n=o[0];this.orbitCamera.pitch-=(n.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(n.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(n.x,n.y)}else if(2==o.length){var h=this.getPinchDistance(o[0],o[1]),c=h-this.lastPinchDistance;this.lastPinchDistance=h,this.orbitCamera.distance-=c*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),this.calcMidPoint(o[0],o[1],i),this.pan(i),this.lastPinchMidPoint.copy(i)}};pc.DEFAULT_HUMAN_HEIGHT=1.67,function(){pc.util={},pc.util.DEBUG=!1,pc.util.DEFAULT_VEC3_0=new pc.Vec3(0,0,0),pc.util.DEFAULT_VEC3_1=new pc.Vec3(1,1,1),pc.util.DEFAULT_QUAT=new pc.Quat(0,0,0,1),pc.util.HIGHLIGHT_ENTITY_GREEN=new pc.Color(.25,.5,.25),pc.util.HIGHLIGHT_ENTITY_RED=new pc.Color(.25,.125,.125),pc.util.HIGHLIGHT_ENTITY_DEFAULT=new pc.Color(0,0,0),pc.util.setEntityAlpha=function(t,n){for(var e=pc.math.clamp(n,0,1),r=pc.util.getMeshInstances(t),i=0;i<r.length;++i)r[i].setParameter("material_opacity",e)},pc.util.setEntityEmissive=function(t,n){for(var e=pc.util.getMeshInstances(t),r=0;r<e.length;++r)e[r].setParameter("material_emissive",n.data3)},pc.util.isMobile=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},pc.util.canPlayOgg=function(){var t=navigator.userAgent.toLowerCase();return!(t.search("safari")>=0&&t.search("chrome")<0)},pc.util.unitCurve=function(t,n){if(1==n)return t;var e=t,r=n-n*e+e;return 0!==r&&(e/=r),e},pc.util.sCurve=function(t){return t*t*(3-2*t)},pc.util.playSoundSlot=function(t,n,e){if(t.sound){var r=t.sound.slots[n];return r&&(e&&(r.volume=e),r.play()),r}return null},pc.util.stopSoundSlot=function(t,n){if(t.sound){var e=t.sound.slots[n];return e&&e.stop(),e}return null},pc.util.pauseSoundSlot=function(t,n){if(t.sound){var e=t.sound.slots[n];return e&&e.pause(),e}return null},pc.util.isPlayingSoundSlot=function(t,n){if(t.sound){var e=t.sound.slots[n];if(e)return e.isPlaying}return!1},pc.util.initSoundSlotAssets=function(t,n){var e=pc.util.canPlayOgg()?".ogg":".mp3",r=n.sound?n.sound.slots:null,i=0;if(r)for(var o in r)if(r.hasOwnProperty(o)){var s=t.assets.find(o+e,"audio");s&&(r[o].asset=s.id,i+=1)}return i};var t=new pc.Vec3;pc.util.getYaw=function(n){var e=t;return n.transformVector(pc.Vec3.FORWARD,e),Math.atan2(-e.x,-e.z)*pc.math.RAD_TO_DEG};var n=new pc.Quat,e=new pc.Quat;pc.util.angleBetweenQuats=function(t,r){var i=n.copy(t).invert(),o=e.mul2(r,i),s=2*Math.acos(pc.math.clamp(o.w,-1,1))*pc.math.RAD_TO_DEG;return s>180&&(s=360-s),s},pc.util.clampQuatToYAxis=function(t){t.x=0,t.z=0;var n=Math.sqrt(t.w*t.w+t.y*t.y);t.w/=n,t.y/=n},pc.util.getMeshInstances=function(t){if(t.model)return t.model.meshInstances;var n=[];if(t instanceof pc.Entity)for(var e=t.findComponents("render"),r=0;r<e.length;++r)for(var i=e[r].meshInstances,o=0;o<i.length;o++)n.push(i[o]);return n}}(),pc.extend(pc,function(){var t=function OrientatedBox(t,n){this.halfExtents=t||new pc.Vec3(.5,.5,.5),this._worldTransform=n||new pc.Mat4,this._modelTransform=this._worldTransform.clone().invert(),this._aabb=new pc.BoundingBox(new pc.Vec3,this.halfExtents)},n=new pc.Ray,e=new pc.Vec3,r=new pc.BoundingSphere;return t.prototype={intersectsRay:function(t,e){if(this._modelTransform.transformPoint(t.origin,n.origin),this._modelTransform.transformVector(t.direction,n.direction),e){var r=this._aabb._intersectsRay(n,e);return this._worldTransform.transformPoint(e,e),r}return modelBox._fastIntersectsRay(this._transformedRay)},containsPoint:function(t){return this._modelTransform.transformPoint(t,e),this._aabb.containsPoint(e)},intersectsBoundingSphere:function(t){return this._modelTransform.transformPoint(t.center,r.center),r.radius=t.radius,!!this._aabb.intersectsBoundingSphere(r)}},Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this._worldTransform},set:function(t){this._worldTransform=t,this._modelTransform.copy(this._worldTransform).invert()}}),{OrientatedBox:t}}()),pc.BoundingSphere.diffBetweenPoints=new pc.Vec3,pc.BoundingSphere.prototype.intersectsBoundingSphere=function(t){var n=pc.BoundingSphere.diffBetweenPoints;n.sub2(t.center,this.center);var e=t.radius+this.radius;return n.lengthSq()<=e*e},pc.BoundingBox.prototype._distanceToBoundingSphereSq=function(t){for(var n=this.getMin(),e=this.getMax(),r=0,i=0;i<3;++i){var o=0,s=t.center.data[i],a=n.data[i],u=e.data[i],c=0;s<a&&(o+=(c=a-s)*c),s>u&&(o+=(c=s-u)*c),r+=o}return r},pc.BoundingBox.prototype.intersectsBoundingSphere=function(t){return this._distanceToBoundingSphereSq(t)<=t.radius*t.radius};ShapeWorld=pc.createScript("shapeWorld"),ShapeWorld.prototype.initialize=function(){this._pickableEntities=[],this._pickableShapes=[],this.app.on("shapeworld:add",this.addItem,this),this.app.on("shapeworld:remove",this.removeItem,this),this.app.shapeWorld=this},ShapeWorld.hitPoint=new pc.Vec3,ShapeWorld.vecBetween=new pc.Vec3,ShapeWorld.prototype.raycast=function(e,t,i,p){for(var a=ShapeWorld.hitPoint,s=(ShapeWorld.vecBetween,p||1/0),h=null,n=0;n<this._pickableShapes.length;++n){var r=this._pickableShapes[n],o=this._pickableEntities[n];if((!t||t(o)&&o.enabled)&&r.intersectsRay(e,a)){var l=e.origin.distance(a);l<s&&(s=l,h=o,i&&i.copy(a))}}return h},ShapeWorld.prototype.containsPoint=function(e,t){for(var i=null,p=0;p<this._pickableShapes.length;++p){var a=this._pickableShapes[p],s=this._pickableEntities[p];if((!t||t(s)&&s.enabled)&&a.containsPoint(e)){i=s;break}}return i},ShapeWorld.prototype.intersectsSphere=function(e,t){for(var i=null,p=0;p<this._pickableShapes.length;++p){var a=this._pickableShapes[p],s=this._pickableEntities[p];if((!t||t(s)&&s.enabled)&&a.intersectsBoundingSphere(e)){i=s;break}}return i},ShapeWorld.prototype.addItem=function(e,t){e&&(this._pickableEntities.push(e),this._pickableShapes.push(t))},ShapeWorld.prototype.removeItem=function(e){var t=this._items.indexOf(e);t>=0&&(this._pickableEntities.splice(t,1),this._pickableShapes.splice(t,1))};var Shape=pc.createScript("shape");Shape.attributes.add("type",{type:"string",enum:[{Sphere:"sphere"},{AABB:"aabb"},{OBB:"obb"}],default:"sphere",title:"Type"}),Shape.attributes.add("childOfActualEntity",{type:"boolean",default:!1,title:"Child Of Actual Entity",description:"Tick if the shape is a child of the actual entity object"}),Shape.attributes.add("keepUpdating",{type:"boolean",default:!1,title:"Keep Updating",description:"Update the shape data every frame (only toggle if the entity moves as can be expensive)"}),Shape.attributes.add("addToObject",{type:"string",enum:[{Global:"app"},{"Actual Entity":"actualEntity"}],title:"Add to Object",default:"app"}),Shape.prototype.initialize=function(){switch(this._halfExtents=this.entity.getLocalScale().clone().scale(.5),this.type){case"sphere":this._shape=new pc.BoundingSphere(this.entity.getPosition().clone(),Math.max(this._halfExtents.x,Math.max(this._halfExtents.y,this._halfExtents.z)));break;case"aabb":this._shape=new pc.BoundingBox(this.entity.getPosition().clone(),this._halfExtents);break;case"obb":this._worldTransform=(new pc.Mat4).setTRS(this.entity.getPosition(),this.entity.getRotation(),pc.util.DEFAULT_VEC3_1),this._shape=new pc.OrientatedBox(this._halfExtents,this._worldTransform)}},Shape.prototype.postInitialize=function(){this._getAddToObject().fire("shapeworld:add",this._getActualEntity(),this._shape)},Shape.prototype.update=function(t){if(this.keepUpdating)switch(this.type){case"sphere":case"aabb":this._shape.center.copy(this.entity.getPosition());break;case"obb":this._worldTransform.setTRS(this.entity.getPosition(),this.entity.getRotation(),pc.util.DEFAULT_VEC3_1),this._shape.worldTransform=this._worldTransform}},Shape.prototype._getAddToObject=function(){switch(this.addToObject){case"app":return this.app;case"actualEntity":return this._getActualEntity();default:return null}},Shape.prototype._getActualEntity=function(){return this.childOfActualEntity?this.entity.parent:this.entity};var EVGetIn=pc.createScript("EVGetIn");EVGetIn.prototype.initialize=function(){this.entity.element.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.entity.element.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.touch&&(this.entity.element.on(pc.EVENT_TOUCHSTART,this.onMouseDown,this),this.entity.element.on(pc.EVENT_TOUCHMOVE,this.onMouseMove,this),this.entity.element.on(pc.EVENT_TOUCHEND,this.onMouseUp,this))},EVGetIn.prototype.onMouseDown=function(t){t.stopPropagation()},EVGetIn.prototype.onMouseUp=function(t){this.doSomething(),t.stopPropagation()},EVGetIn.prototype.onMouseMove=function(t){t.stopPropagation()},EVGetIn.prototype.doSomething=function(){var t=this.app;t.root.findByName("FlyCamera").script.orbitCamera.reset(t.root.findByName("FlyCamera").script.KeyboardInputFly.startYaw,t.root.findByName("FlyCamera").script.KeyboardInputFly.startPitch,t.root.findByName("FlyCamera").script.KeyboardInputFly.startDistance),t.root.findByName("FlyCamera").script.orbitCamera.pivotPoint=t.root.findByName("FlyCamera").script.KeyboardInputFly.startPivotPosition,t.root.findByName("WalkPlayer").enabled=!1,t.root.findByName("MapCameras").enabled=!1,t.root.findByName("FlyCamera").enabled=!0,t.root.findByName("EV_Use").enabled=!0,document.getElementById("camera-button").classList.add("hidden"),document.getElementById("map-button").classList.add("hidden"),t.root.findByName("FlyCamera").script.orbitCamera.enabled=!1,t.root.findByName("FlyCamera").enabled&&(t.scene.exposure=1)};var VirtualJoystick=pc.createScript("virtualJoystick");VirtualJoystick.attributes.add("stick",{type:"entity"}),VirtualJoystick.attributes.add("enableEvent",{type:"string"}),VirtualJoystick.attributes.add("moveEvent",{type:"string"}),VirtualJoystick.attributes.add("disableEvent",{type:"string"}),VirtualJoystick.prototype.initialize=function(){var t=this.app;t.on(this.enableEvent,(function(t,i){this.entity.setLocalPosition(t,-i,0),this.stick.setLocalPosition(t,-i,0),this.entity.element.enabled=!0,this.stick.element.enabled=!0}),this),t.on(this.moveEvent,(function(t,i){this.stick.setLocalPosition(t,-i,0)}),this),t.on(this.disableEvent,(function(){this.entity.element.enabled=!1,this.stick.element.enabled=!1}),this)};var EvVr=pc.createScript("evVr");EvVr.attributes.add("targetPosition",{type:"entity",title:"targetPosition"}),EvVr.prototype.initialize=function(){this.entity.button.on("click",(function(){this.doSomething()}),this)},EvVr.prototype.doSomething=function(){var t=this.app,i=this.targetPosition.getPosition();t.root.findByName("Camera Offset").setPosition(i.x,i.y-.875,i.z)};var EVLeave=pc.createScript("EVLeave");EVLeave.prototype.initialize=function(){this.entity.element.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.entity.element.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.touch&&(this.entity.element.on(pc.EVENT_TOUCHSTART,this.onMouseDown,this),this.entity.element.on(pc.EVENT_TOUCHMOVE,this.onMouseMove,this),this.entity.element.on(pc.EVENT_TOUCHEND,this.onMouseUp,this))},EVLeave.prototype.onMouseDown=function(e){e.stopPropagation()},EVLeave.prototype.onMouseUp=function(e){this.doSomething(),e.stopPropagation()},EVLeave.prototype.onMouseMove=function(e){e.stopPropagation()},EVLeave.prototype.doSomething=function(){var e=this.app;e.root.findByName("FlyCamera").enabled=!1,e.root.findByName("MapCameras").enabled=!1,e.root.findByName("EV_GetIn").enabled=!1,e.root.findByName("EV_Use").enabled=!1,e.root.findByName("WalkPlayer").enabled=!0,document.getElementById("camera-button").classList.remove("hidden"),document.getElementById("map-button").classList.remove("hidden"),e.root.findByName("FlyCamera").script.orbitCamera.enabled=!0};var LocatorRings=pc.createScript("locatorRings");LocatorRings.attributes.add("animLength",{type:"number",default:1,title:"Anim Length (secs)"}),LocatorRings.attributes.add("loopGap",{type:"number",default:1,title:"Loop Gap (secs)"}),LocatorRings.attributes.add("yOffsetCurve",{type:"curve",title:"Y Offset Curve"}),LocatorRings.attributes.add("scaleOffsetCurve",{type:"curve",title:"Scale Offset Curve"}),LocatorRings.attributes.add("alphaCurve",{type:"curve",title:"Alpha Curve"}),LocatorRings.prototype.initialize=function(){this._rings=this.entity.findByTag("locator-ring"),this._ringCount=this._rings.length,this._time=0,this._targetScaleY=1,this._setScaleY(.001),this.on("state",this._onStateChanged,this)},LocatorRings.ringPosition=new pc.Vec3,LocatorRings.SCALE_LERP_FACTOR=8,LocatorRings.prototype.update=function(t){var e=this._time/this.animLength,i=LocatorRings.ringPosition;LocatorRings.ringScale;if(e<=1)for(var a=0;a<this._ringCount;++a){var s=(e+1/this._ringCount*a)%1,o=this._rings[a];i.copy(o.getLocalPosition()),i.y=this.yOffsetCurve.value(s),o.setLocalPosition(i);var n=this.scaleOffsetCurve.value(s);o.setLocalScale(n,n,n),pc.util.setEntityAlpha(o,this.alphaCurve.value(s))}this._time=(this._time+t)%(this.animLength+this.loopGap);var r=this.entity.getLocalScale();this._setScaleY(pc.math.lerp(r.y,this._targetScaleY,Math.min(LocatorRings.SCALE_LERP_FACTOR*t,1)))},LocatorRings.prototype._onStateChanged=function(t){t&&(this._setScaleY(.001),this._targetScaleY=1)},LocatorRings.prototype._setScaleY=function(t){var e=this.entity.getLocalScale();e.y=t,this.entity.setLocalScale(e)};var MouseInputFly=pc.createScript("MouseInputFly");MouseInputFly.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInputFly.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInputFly.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,onMouseOut=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",onMouseOut,!1),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",onMouseOut,!1)}))}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInputFly.fromWorldPoint=new pc.Vec3,MouseInputFly.toWorldPoint=new pc.Vec3,MouseInputFly.worldDiff=new pc.Vec3,MouseInputFly.prototype.pan=function(t){var o=MouseInputFly.fromWorldPoint,e=MouseInputFly.toWorldPoint,i=MouseInputFly.worldDiff,s=this.entity.camera,n=this.orbitCamera.distance;s.screenToWorld(t.x,t.y,n,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,n,e),i.sub2(e,o),this.orbitCamera.pivotPoint.add(i)},MouseInputFly.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!0}},MouseInputFly.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}},MouseInputFly.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInputFly.prototype.onMouseWheel=function(t){this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault()},MouseInputFly.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};pc.extend(pc,function(){var FxaaEffect=function(e){var o={aPosition:pc.SEMANTIC_POSITION},r=["attribute vec2 aPosition;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","}"].join("\n"),a=["precision "+e.precision+" float;","","uniform sampler2D uColorBuffer;","uniform vec2 uResolution;","","#define FXAA_REDUCE_MIN   (1.0/128.0)","#define FXAA_REDUCE_MUL   (1.0/8.0)","#define FXAA_SPAN_MAX     8.0","","void main()","{","    vec3 rgbNW = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * uResolution ).xyz;","    vec3 rgbNE = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * uResolution ).xyz;","    vec3 rgbSW = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * uResolution ).xyz;","    vec3 rgbSE = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * uResolution ).xyz;","    vec4 rgbaM  = texture2D( uColorBuffer,  gl_FragCoord.xy  * uResolution );","    vec3 rgbM  = rgbaM.xyz;","    float opacity  = rgbaM.w;","","    vec3 luma = vec3( 0.299, 0.587, 0.114 );","","    float lumaNW = dot( rgbNW, luma );","    float lumaNE = dot( rgbNE, luma );","    float lumaSW = dot( rgbSW, luma );","    float lumaSE = dot( rgbSE, luma );","    float lumaM  = dot( rgbM,  luma );","    float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );","    float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );","","    vec2 dir;","    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));","    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));","","    float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );","","    float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );","    dir = min( vec2( FXAA_SPAN_MAX, FXAA_SPAN_MAX), max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) * uResolution;","","    vec3 rgbA = 0.5 * (","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * ( 1.0 / 3.0 - 0.5 ) ).xyz +","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * ( 2.0 / 3.0 - 0.5 ) ).xyz );","","    vec3 rgbB = rgbA * 0.5 + 0.25 * (","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * -0.5 ).xyz +","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * 0.5 ).xyz );","","    float lumaB = dot( rgbB, luma );","","    if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )","    {","        gl_FragColor = vec4( rgbA, opacity );","    }","    else","    {","        gl_FragColor = vec4( rgbB, opacity );","    }","}"].join("\n");this.fxaaShader=new pc.Shader(e,{attributes:o,vshader:r,fshader:a}),this.resolution=new Float32Array(2)};return(FxaaEffect=pc.inherits(FxaaEffect,pc.PostEffect)).prototype=pc.extend(FxaaEffect.prototype,{render:function(e,o,r){var a=this.device,t=a.scope;this.resolution[0]=1/e.width,this.resolution[1]=1/e.height,t.resolve("uResolution").setValue(this.resolution),t.resolve("uColorBuffer").setValue(e.colorBuffer),pc.drawFullscreenQuad(a,o,this.vertexBuffer,this.fxaaShader,r)}}),{FxaaEffect:FxaaEffect}}());var Fxaa=pc.createScript("fxaa");Fxaa.prototype.initialize=function(){this.effect=new pc.FxaaEffect(this.app.graphicsDevice);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(o){o?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};var EVUse=pc.createScript("EVUse");EVUse.attributes.add("targetPosition",{type:"entity",title:"targetPosition"}),EVUse.prototype.initialize=function(){this.entity.element.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.entity.element.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.touch&&(this.entity.element.on(pc.EVENT_TOUCHSTART,this.onMouseDown,this),this.entity.element.on(pc.EVENT_TOUCHMOVE,this.onMouseMove,this),this.entity.element.on(pc.EVENT_TOUCHEND,this.onMouseUp,this))},EVUse.prototype.onMouseDown=function(t){t.stopPropagation()},EVUse.prototype.onMouseUp=function(t){this.doSomething(),t.stopPropagation()},EVUse.prototype.onMouseMove=function(t){t.stopPropagation()},EVUse.prototype.doSomething=function(){var t=this.app,e=this.targetPosition.getPosition();t.root.findByName("WalkPlayer").setPosition(e.x,e.y,e.z),t.root.findByName("FlyCamera").enabled=!1,t.root.findByName("MapCameras").enabled=!1,t.root.findByName("EV_Use").enabled=!1,t.root.findByName("WalkPlayer").enabled=!0,document.getElementById("camera-button").classList.remove("hidden"),document.getElementById("map-button").classList.remove("hidden"),t.root.findByName("FlyCamera").script.orbitCamera.enabled=!0};pc.extend(pc,function(){var HueSaturationEffect=function(t){this.shader=new pc.Shader(t,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:["precision "+t.precision+" float;","uniform sampler2D uColorBuffer;","uniform float uHue;","uniform float uSaturation;","varying vec2 vUv0;","void main() {","gl_FragColor = texture2D( uColorBuffer, vUv0 );","float angle = uHue * 3.14159265;","float s = sin(angle), c = cos(angle);","vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","float len = length(gl_FragColor.rgb);","gl_FragColor.rgb = vec3(","dot(gl_FragColor.rgb, weights.xyz),","dot(gl_FragColor.rgb, weights.zxy),","dot(gl_FragColor.rgb, weights.yzx)",");","float average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","if (uSaturation > 0.0) {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - uSaturation));","} else {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (-uSaturation);","}","}"].join("\n")}),this.hue=0,this.saturation=0};return(HueSaturationEffect=pc.inherits(HueSaturationEffect,pc.PostEffect)).prototype=pc.extend(HueSaturationEffect.prototype,{render:function(t,e,r){var o=this.device,a=o.scope;a.resolve("uHue").setValue(this.hue),a.resolve("uSaturation").setValue(this.saturation),a.resolve("uColorBuffer").setValue(t.colorBuffer),pc.drawFullscreenQuad(o,e,this.vertexBuffer,this.shader,r)}}),{HueSaturationEffect:HueSaturationEffect}}());var HueSaturation=pc.createScript("hueSaturation");HueSaturation.attributes.add("hue",{type:"number",default:0,min:-1,max:1,precision:5,title:"Hue"}),HueSaturation.attributes.add("saturation",{type:"number",default:0,min:-1,max:1,precision:5,title:"Saturation"}),HueSaturation.prototype.initialize=function(){this.effect=new pc.HueSaturationEffect(this.app.graphicsDevice),this.effect.hue=this.hue,this.effect.saturation=this.saturation,this.on("attr",(function(t,e){this.effect[t]=e}),this);var t=this.entity.camera.postEffects;t.addEffect(this.effect),this.on("state",(function(e){e?t.addEffect(this.effect):t.removeEffect(this.effect)})),this.on("destroy",(function(){t.removeEffect(this.effect)}))};document.addEventListener("contextmenu",(function(e){e.preventDefault()}));var TeleportCamera=pc.createScript("teleportCamera");TeleportCamera.prototype.initialize=function(){this.app.on("teleport:to",(function(t){this.entity.setPosition(t)}),this)};var Controller=pc.createScript("controller");Controller.attributes.add("maxGrabDistance",{type:"number",title:"Max Grab Distance",default:.1}),Controller.prototype.initialize=function(){this.ray=new pc.Ray,this.vecA=new pc.Vec3,this.vecB=new pc.Vec3,this.quat=new pc.Quat,this.color=new pc.Color(1,1,1),this.holdingEntity=null,this.teleportableEntity=null,this.hoverEntity=null,this.hoverPoint=new pc.Vec3,this.teleportable=!0,this.active=!0,this.mouseCoords=new pc.Vec2,this.holdingDistance=0,this.holdingOffset=new pc.Vec3,this.holdingNoOffset=!0,this.modelEntity=this.entity.findByName("Model"),this.grabAnchor=new pc.Entity,this.grabAnchor.reparent(this.entity)},Controller.prototype.setInputSource=function(t,i){var e=this;if(this.inputSource=t,this.inputSource.once("remove",this.onRemove,this),this.on("hover",this.onHover,this),this.on("blur",this.onBlur,this),this.inputSource.on("selectstart",this.onSelectStart,this),this.inputSource.on("selectend",this.onSelectEnd,this),t.hand){this.joints=[];for(var o=new pc.StandardMaterial,s=0;s<t.hand.joints.length;s++){var n=t.hand.joints[s],h=new pc.Entity;h.addComponent("model",{type:"box"}),h.joint=n,h.model.material=o,this.joints.push(h),this.entity.addChild(h)}t.hand.on("trackinglost",(function(){this.joints[0].model.material.diffuse.set(1,0,0),this.joints[0].model.material.update()}),this),t.hand.on("tracking",(function(){this.joints[0].model.material.diffuse.set(1,1,1),this.joints[0].model.material.update()}),this)}else i&&(i.ready((function(){if(this.entity.parent){var t=i.resource,o=new Blob([t]);this.app.assets.loadFromUrlAndFilename(URL.createObjectURL(o),"container.glb","container",(function(t,i){if(!e.entity.parent)return i.unload(),void e.app.assets.remove(i);t?console.error(t):(e.modelEntity.setLocalScale(1,1,1),e.modelEntity.model.type="asset",e.modelEntity.model.asset=i.resource.model,e.modelEntity.containerAsset=i)}))}}),this),this.app.assets.load(i))},Controller.prototype.onRemove=function(){this.modelEntity.containerAsset&&(console.log(this.modelEntity.containerAsset),this.modelEntity.containerAsset.unload(),this.app.assets.remove(this.modelEntity.containerAsset),this.modelEntity.containerAsset=null),this.entity.destroy()},Controller.prototype.onSelectStart=function(){this.pick(),this.teleportableEntity?this.app.xr.active&&(this.app.fire("teleport:to",this.hoverPoint),this.hoverEntity.fire("object:interact",this)):this.hoverEntity&&!this.holdingEntity&&this.hoverEntity.fire("object:hold",this)},Controller.prototype.onSelectEnd=function(){this.teleportableEntity&&!this.app.xr.active&&this.teleportable&&this.app.fire("teleport:to",this.hoverPoint),this.hoverEntity&&this.hoverEntity.fire("object:attemptuse",this),this.holdingEntity&&this.holdingEntity.fire("object:release",this)},Controller.prototype.getAttachPosition=function(){return this.grabAnchor.getPosition()},Controller.prototype.getAttachRotation=function(){return this.grabAnchor.getRotation()},Controller.prototype.attach=function(t){this.holdingEntity||(this.holdingEntity=t,this.grabAnchor.setPosition(t.getPosition()),this.holdingDistance=t.getPosition().distance(this.app.mainCamera.getPosition()))},Controller.prototype.detach=function(t){this.holdingEntity&&(this.holdingEntity=null)},Controller.prototype.getHeldEntity=function(){return this.holdingEntity},Controller.prototype.updateAttachment=function(t,i){t.setPosition(this.getAttachPosition()),this.quat.mul2(this.getAttachRotation(),i),t.setRotation(this.quat)},Controller.prototype.filterPicker=function(t){return this.holdingEntity!==t},Controller.prototype.pick=function(){this.inputSource?this.ray.set(this.inputSource.getOrigin(),this.inputSource.getDirection()):pc.Mouse.isPointerLocked()?this.ray.set(this.app.mainCamera.getPosition(),this.app.mainCamera.forward):(this.app.mainCamera.camera.screenToWorld(this.mouseCoords.x,this.mouseCoords.y,this.app.mainCamera.camera.nearClip,this.vecA),this.app.mainCamera.camera.screenToWorld(this.mouseCoords.x,this.mouseCoords.y,this.app.mainCamera.camera.farClip,this.vecB),this.vecB.sub(this.vecA).normalize(),this.ray.set(this.vecA,this.vecB),this.holdingEntity?(this.vecB.scale(this.holdingDistance),this.vecB.add(this.vecA),this.holdingNoOffset&&(this.holdingNoOffset=!1,this.holdingOffset.copy(this.grabAnchor.getPosition()).sub(this.vecB)),this.vecB.add(this.holdingOffset),this.grabAnchor.setPosition(this.vecB)):this.holdingNoOffset=!0);var t=this.app.shapeWorld.raycast(this.ray,this.filterPicker.bind(this),this.hoverPoint),i=!1;(this.active||(t=null),this.hoverEntity!==t&&(this.hoverEntity&&this.hoverEntity.fire("object:offhover",this),t&&t.fire("object:onhover",this),this.hoverEntity=t),this.hoverEntity)&&(this.holdingEntity||this.hoverEntity.tags.has("floor")&&this.hoverEntity.up.dot(this.ray.direction)<=0&&(i=!0));this.teleportableEntity=i?this.hoverEntity:null},Controller.prototype.update=function(t){if(this.inputSource&&"gaze"!==this.inputSource.targetRayMode&&(this.vecA.copy(this.inputSource.getOrigin()),this.vecB.copy(this.inputSource.getDirection()),this.vecB.scale(1e3).add(this.vecA),this.inputSource.selecting?this.color.set(0,1,0):this.color.set(1,1,1),this.app.renderLine(this.vecA,this.vecB,this.color)),this.inputSource&&this.inputSource.hand)for(var i=0;i<this.joints.length;i++){var e=this.joints[i].joint,o=2*e.radius;this.joints[i].setLocalScale(o,o,o),this.joints[i].setPosition(e.getPosition()),this.joints[i].setRotation(e.getRotation())}else this.inputSource&&this.inputSource.grip?(this.modelEntity.enabled=!0,this.entity.setPosition(this.inputSource.getPosition()),this.entity.setRotation(this.inputSource.getRotation())):(this.modelEntity.enabled=!1,this.inputSource&&"gaze"!==this.inputSource.targetRayMode||(this.entity.setPosition(this.app.mainCamera.getPosition()),this.entity.setRotation(this.app.mainCamera.getRotation())));this.pick(),this.teleportableEntity?(this.vecB.copy(this.hoverEntity.up).scale(.01),this.vecA.copy(this.hoverPoint).add(this.vecB),this.app.fire("teleport:transform",this.vecA,this.hoverEntity.getRotation()),this.app.fire("teleport:show")):this.app.fire("teleport:hide")};var AutoExposureVr=pc.createScript("autoExposureVr");AutoExposureVr.attributes.add("targetExposure",{type:"number",default:2}),AutoExposureVr.prototype.initialize=function(){this.entity.on("object:interact",this._onInteract,this),this.entity.on("object:onhover",this._onHover,this),this._state=0,this._time=0},AutoExposureVr.prototype.update=function(t){},AutoExposureVr.prototype._onInteract=function(t){this._isIdle()&&(this._time=0,this._state=1,this.app.fire("PhaseMover:phase",e=this.targetExposure))},AutoExposureVr.prototype._onHover=function(){this._isIdle()&&(this.alpha=0,this.value=this.app.scene.exposure,this.start=this.app.scene.exposure,this.end=this.targetExposure)},AutoExposureVr.prototype._isIdle=function(){return 0==this._state};var Screen=pc.createScript("screen");Screen.attributes.add("landscapeOrthoheight",{type:"number",default:10}),Screen.attributes.add("portraitOrthoheight",{type:"number",default:20}),Screen.attributes.add("landscapeAngle",{type:"number",default:0}),Screen.attributes.add("portraitAngle",{type:"number",default:0}),Screen.prototype.initialize=function(){var e=window.innerWidth,a=window.innerHeight;e>a?(this.app.root.findByName("PlayerMapCamera").camera.orthoHeight=this.landscapeOrthoheight,this.app.root.findByName("PlanCamera").camera.orthoHeight=this.landscapeOrthoheight):e===a||(this.app.root.findByName("MapCameras").setLocalEulerAngles(0,this.portraitAngle,0),this.app.root.findByName("PlayerMapCamera").camera.orthoHeight=this.portraitOrthoheight,this.app.root.findByName("PlanCamera").camera.orthoHeight=this.portraitOrthoheight)},Screen.prototype.update=function(e){var a=this;function calculateDimensions(){var e=window.innerWidth,t=window.innerHeight;e>t?(a.app.root.findByName("MapCameras").setLocalEulerAngles(0,a.landscapeAngle,0),a.app.root.findByName("PlayerMapCamera").camera.orthoHeight=a.landscapeOrthoheight,a.app.root.findByName("PlanCamera").camera.orthoHeight=a.landscapeOrthoheight):e===t||(a.app.root.findByName("MapCameras").setLocalEulerAngles(0,a.portraitAngle,0),a.app.root.findByName("PlayerMapCamera").camera.orthoHeight=a.portraitOrthoheight,a.app.root.findByName("PlanCamera").camera.orthoHeight=a.portraitOrthoheight)}window.addEventListener("orientationchange",calculateDimensions,!1),window.addEventListener("resize",calculateDimensions,!1)};var GlbAddAnim=pc.createScript("glbAddAnim");GlbAddAnim.attributes.add("glbAsset",{type:"asset",assetType:"binary"}),GlbAddAnim.attributes.add("collisionOn",{type:"boolean",default:!1,title:"CollisionOn",description:"defines if collision will be on or not"}),GlbAddAnim.attributes.add("tag",{type:"string",default:".png",title:"tag"}),GlbAddAnim.prototype.initialize=function(){this.state=0,this.state_fit=0;var t=this;this.collisionOn;utils.loadGlbContainerFromAsset(this.glbAsset,null,this.glbAsset.name,(function(i,s){var e=s.resource.instantiateRenderEntity();t.entity.addChild(e),e.addComponent("anim",{activate:!0}),currentlayer=[];for(let t=0;t<s.resource.animations.length;t++)currentlayer[t]=e.anim.addLayer("Animation "+t,1,null,"ADDITIVE"),e.anim.assignAnimation("Animation "+t,s.resource.animations[t].resource,"Animation "+t,1,!1);assignChildColRigid=function(i){achild=i._children;for(let i=0;i<achild.length;i++)if(console.log(achild[i].render),null!=achild[i].render){var s=achild[i].render._meshInstances[0].material.name,e=s.split(".")[0]+t.tag,a=t.app.assets.find(e,"texture");if(a){var n=a.resource;material=achild[i].render._meshInstances[0].material,material.name=s,material.diffuseMap=n,material.opacityMap=n,material._useSkybox=!1,material._useLighting=!1,material._useFog=!1,material.update()}achild[i].render._meshInstances[0]._material._emissiveIntensity=0}0!=i._children.length&&callGroup(i._children)},callGroup=function(t){for(let i=0;i<t.length;i++)assignChildColRigid(t[i])},assignChildColRigid(e),t.app.on("addAnim:Speed",(function(t){e.anim.speed=t})),t.app.on("addAnim:Loop",(function(t){st=0,st+=e.anim.baseLayer.activeStateProgress;for(let t=0;t<currentlayer.length;t++)st+=currentlayer[t].activeStateProgress;if(st>=currentlayer.length+1)for(let t=0;t<currentlayer.length;t++)e.anim.baseLayer.reset(),e.anim.baseLayer.play(),currentlayer[t].reset(),currentlayer[t].play()}))})),this.dictObject={},this.dictDifObject={},this.lerpObject={},this.startObject={},this.alphaObject={},this.getMovementDif=function(t,i){if(this.childList=t._children,null!=this.childList){for(let t=0;t<this.childList.length;t++)null!=this.childList[t].render&&(this.npos=new pc.Vec3(this.childList[t].position.x,this.childList[t].position.y,this.childList[t].position.z),null==this.dictObject[this.childList[t].name]?this.difference=0:this.difference=this.getDistance(this.npos,this.dictObject[this.childList[t].name])/i,this.difference>.001?this.isFast=1:this.isFast=0,this.dictDifObject[this.childList[t].name]!=this.isFast?(this.alpha=0,null==this.startObject[this.childList[t].name]?this.startObject[this.childList[t].name]=1-this.isFast:this.startObject[this.childList[t].name]=this.lerpObject[this.childList[t].name],this.dictDifObject[this.childList[t].name]=this.isFast):this.alphaObject[this.childList[t].name]+i<1?this.alpha=this.alphaObject[this.childList[t].name]+i:this.alpha=1,this.lerpObject[this.childList[t].name]=pc.math.lerp(this.startObject[this.childList[t].name],this.isFast,this.alpha),this.dictObject[this.childList[t].name]=this.npos,this.dictDifObject[this.childList[t].name]=this.isFast,this.alphaObject[this.childList[t].name]=this.alpha);0!=this.childList.length&&this.callGroupEmission(t._children,i)}},this.callGroupEmission=function(t,i){for(let s=0;s<t.length;s++)this.getMovementDif(t[s],i)},this.getDistance=function(t,i){return this.difx=t.x-i.x,this.dify=t.y-i.y,this.difz=t.z-i.z,Math.pow(this.difx,2)+Math.pow(this.dify,2)+Math.pow(this.difz,2)}},GlbAddAnim.prototype.update=function(t){if(this.state_fit<0?this.state_fit+=1:this.state_fit=0,this.scene=this.entity.children[0],null!=this.scene&&0==this.state_fit){this.getMovementDif(this.scene,t);for(const[t,i]of Object.entries(this.lerpObject));}this.app.keyboard.wasPressed(pc.KEY_SPACE)&&(this.state=1-this.state),0==this.state?this.count<1?this.count+=2*t:this.count=1:this.count>0?this.count-=2*t:this.count=0,this.app.fire("addAnim:Speed",this.count),this.app.fire("addAnim:Loop")};var SAMPLE_COUNT=15;function computeGaussian(e,t){return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-e*e/(2*t*t))}function calculateBlurValues(e,t,o,s,r){e[0]=computeGaussian(0,r),t[0]=0,t[1]=0;var i,l,a=e[0];for(i=0,l=Math.floor(SAMPLE_COUNT/2);i<l;i++){var u=computeGaussian(i+1,r);e[2*i]=u,e[2*i+1]=u,a+=2*u;var h=2*i+1.5;t[4*i]=o*h,t[4*i+1]=s*h,t[4*i+2]=-o*h,t[4*i+3]=-s*h}for(i=0,l=e.length;i<l;i++)e[i]/=a}function BloomEffect(e){pc.PostEffect.call(this,e);var t={aPosition:pc.SEMANTIC_POSITION},o=["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition + 1.0) * 0.5;","}"].join("\n"),s=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform sampler2D uBaseTexture;","uniform float uBloomThreshold;","","void main(void)","{","    vec4 color = texture2D(uBaseTexture, vUv0);","","    gl_FragColor = clamp((color - uBloomThreshold) / (1.0 - uBloomThreshold), 0.0, 1.0);","}"].join("\n"),r=["precision "+e.precision+" float;","","#define SAMPLE_COUNT "+SAMPLE_COUNT,"","varying vec2 vUv0;","","uniform sampler2D uBloomTexture;","uniform vec2 uBlurOffsets[SAMPLE_COUNT];","uniform float uBlurWeights[SAMPLE_COUNT];","","void main(void)","{","    vec4 color = vec4(0.0);","    for (int i = 0; i < SAMPLE_COUNT; i++)","    {","        color += texture2D(uBloomTexture, vUv0 + uBlurOffsets[i]) * uBlurWeights[i];","    }","","    gl_FragColor = color;","}"].join("\n"),i=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform float uBloomEffectIntensity;","uniform sampler2D uBaseTexture;","uniform sampler2D uBloomTexture;","","void main(void)","{","    vec4 bloom = texture2D(uBloomTexture, vUv0) * uBloomEffectIntensity;","    vec4 base = texture2D(uBaseTexture, vUv0);","","    base *= (1.0 - clamp(bloom, 0.0, 1.0));","","    gl_FragColor = base + bloom;","}"].join("\n");this.extractShader=new pc.Shader(e,{attributes:t,vshader:o,fshader:s}),this.blurShader=new pc.Shader(e,{attributes:t,vshader:o,fshader:r}),this.combineShader=new pc.Shader(e,{attributes:t,vshader:o,fshader:i}),this.targets=[],this.bloomThreshold=.25,this.blurAmount=4,this.bloomIntensity=1.25,this.sampleWeights=new Float32Array(SAMPLE_COUNT),this.sampleOffsets=new Float32Array(2*SAMPLE_COUNT)}BloomEffect.prototype=Object.create(pc.PostEffect.prototype),BloomEffect.prototype.constructor=BloomEffect,BloomEffect.prototype._destroy=function(){var e;if(this.targets)for(e=0;e<this.targets.length;e++)this.targets[e].destroyTextureBuffers(),this.targets[e].destroy();this.targets.length=0},BloomEffect.prototype._resize=function(e){var t,o=e.colorBuffer.width,s=e.colorBuffer.height;if(o!==this.width||s!==this.height)for(this.width=o,this.height=s,this._destroy(),t=0;t<2;t++){var r=new pc.Texture(this.device,{name:"Bloom Texture"+t,format:pc.PIXELFORMAT_R8_G8_B8_A8,width:o>>1,height:s>>1,mipmaps:!1});r.minFilter=pc.FILTER_LINEAR,r.magFilter=pc.FILTER_LINEAR,r.addressU=pc.ADDRESS_CLAMP_TO_EDGE,r.addressV=pc.ADDRESS_CLAMP_TO_EDGE,r.name="pe-bloom";var i=new pc.RenderTarget({name:"Bloom Render Target "+t,colorBuffer:r,depth:!1});this.targets.push(i)}},Object.assign(BloomEffect.prototype,{render:function(e,t,o){this._resize(e);var s=this.device,r=s.scope;r.resolve("uBloomThreshold").setValue(this.bloomThreshold),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(s,this.targets[0],this.vertexBuffer,this.extractShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,1/this.targets[1].width,0,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),pc.drawFullscreenQuad(s,this.targets[1],this.vertexBuffer,this.blurShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,0,1/this.targets[0].height,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[1].colorBuffer),pc.drawFullscreenQuad(s,this.targets[0],this.vertexBuffer,this.blurShader),r.resolve("uBloomEffectIntensity").setValue(this.bloomIntensity),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(s,t,this.vertexBuffer,this.combineShader,o)}});var Bloom=pc.createScript("bloom");Bloom.attributes.add("bloomIntensity",{type:"number",default:1,min:0,title:"Intensity"}),Bloom.attributes.add("bloomThreshold",{type:"number",default:.25,min:0,max:1,title:"Threshold"}),Bloom.attributes.add("blurAmount",{type:"number",default:4,min:1,title:"Blur amount"}),Bloom.prototype.initialize=function(){this.effect=new BloomEffect(this.app.graphicsDevice),this.effect.bloomThreshold=this.bloomThreshold,this.effect.blurAmount=this.blurAmount,this.effect.bloomIntensity=this.bloomIntensity;var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("attr",(function(e,t){this.effect[e]=t}),this),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect),this._destroy()}))};var FadeInfadeOutCamera=pc.createScript("fadeInfadeOutCamera");FadeInfadeOutCamera.attributes.add("lerpSmoothness",{type:"number",title:"LerpSmoothness"}),FadeInfadeOutCamera.prototype.initialize=function(){this.time=0,this.state=0,this.pastPosSum=0,this.tValue=0,this.previous_Exp=0},FadeInfadeOutCamera.prototype.update=function(e){0==this.state&&(camera=this.entity.findByName("Camera"),currentPos=camera.position,currentPosSum=currentPos.x+currentPos.y+currentPos.z,difference=Math.abs(currentPosSum-this.pastPosSum),this.pastPosSum=currentPosSum,difference/e>30?expos_value=.001:difference/e>.2?expos_value=.999:expos_value=.001),this.time+=1.7*e,this.time>=1&&(this.time=1),this.previous_Exp!=expos_value&&(currentExp=1-this.tValue,this.time=0),this.tValue=1-pc.math.lerp(currentExp,expos_value,this.time),this.tValue>.9&&(this.tValue=1),this.entity.findByName("FadeInOut").render.meshInstances[0].setParameter("material_opacity",this.tValue),this.previous_Exp=expos_value,this.state+=1,this.state>=2&&(this.state=0),this.entity.findByName("Armature").anim.baseLayer.activeStateProgress>1&&(this.app.scene.exposure=1,this.app.fire("track_Start"))};!function(){var n={},e=pc.Application.getApplication();n.loadGlbContainerFromAsset=function(n,t,o,a){var r=function(n){var e=new Blob([n.resource]),r=URL.createObjectURL(e);return this.loadGlbContainerFromUrl(r,t,o,(function(n,e){a(n,e),URL.revokeObjectURL(r)}))}.bind(this);n.ready(r),e.assets.load(n)},n.loadGlbContainerFromUrl=function(n,t,o,a){var r=o+".glb",i={url:n,filename:r},l=new pc.Asset(r,"container",i,null,t);return l.once("load",(function(n){if(a){var e=n.resource.animations;if(1==e.length)e[0].name=o;else if(e.length>1)for(var t=0;t<e.length;++t)e[t].name=o+" "+t.toString();a(null,n)}})),e.assets.add(l),e.assets.load(l),l},window.utils=n}();pc.script.createLoadingScreen((function(A){!function(){var A=document.createElement("style");A.innerHTML="body {background-color: #283538;}.mySlides {display: none}img {vertical-align: middle;}/* Slideshow container */.slideshow-container {  max-width: 640px;  position: absolute;  margin: 0 auto;  vertical-align: middle;  top: 50%;  left: 50%;   transform: translateX(-50%) translateY(-50%);}#progress-bar-container {    margin: 20px auto 0 auto;    height: 2px;    width: 100%;    background-color: #ffffff;}#progress-bar {    width: 0%;    height: 100%;    background-color: #f60;}/* Fading animation */.fade {  animation-name: fade;  animation-duration: 5s;  -webkit-transform: translateZ(0);}@keyframes fade {  0%, 100% {opacity: 0}   25%, 75% {opacity: 1}}/* On smaller screens, decrease text size */@media (max-width: 480px) {    #application-splash {        width: 170px;        left: calc(50% - 85px);    }}",document.head.appendChild(A);splash=document.createElement("div"),splash.id="splash",splash.innerHTML='<div class="slideshow-container"><div class="mySlides fade">  <img src="data:image/png;base64,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EoEAAEEiEAAgSAQCAASJQACAIBEIABAkAgEAgkQgAEDQpaEDO3dhwAB/sxMIABAkAgEAgkQgAECQCAQACBKBAABBIhAAIEgEAgAEiUAAgCARCAAQJAIBAIJEIABAkAgEAAgSgQAAQSIQACBIBAIABIlAAIAgEQgAECQCAQCCRCAAQJAIBAAIEoEAAEEiEAAgSAQCAASJQACAIBEIABAkAgEAgkQgAECQCAQACBKBAABBIhAAIEgEAgAEiUAAgCARCAAQJAIBAIJEIABAkAgEAAgSgQAAQSIQACBIBAIABIlAAIAgEQgAECQCAQCCRCAAQJAIBAAIEoEAAEEiEAAgSAQCAASJQACAIBEIABAkAgEAgkQgAECQCAQACBKBAABBIhAAIEgEAgAEiUAAgCARCAAQJAIBAIJEIABAkAgEAAgSgQAAQSIQACBIBAIABIlAAIAgEQgAECQCAQCCRCAAQJAIBAAIEoEAAEEiEAAgSAQCAASJQACAIBEIABAkAgEAgkQgAECQCAQACBKBAABBIhAAIEgEAgAEiUAAgCARCAAQJAIBAIJEIABAkAgEAAgSgQAAQSIQACBIBAIABIlAAIAgEQgAECQCAQCCRCAAQJAIBAAIEoEAAEEiEAAgSAQCAASJQACAIBEIABAkAgEAgkQgAECQCAQACBKBAABBIhAAIEgEAgAEiUAAgCARCAAQJAIBAIJEIABAkAgEAAgSgQAAQSIQACBIBAIABIlAAIAgEQgAECQCAQCCRCAAQJAIBAAIEoEAAEEiEAAgSAQCAASJQACAIBEIABAkAgEAgkQgAECQCAQACBKBAABBIhAAIEgEAgAEiUAAgCARCAAQJAIBAIJEIABAkAgEAAgSgQAAQSIQACBIBAIABIlAAIAgEQgAECQCAQCCRCAAQJAIBAAIEoEAAEEiEAAgSAQCAASJQACAIBEIABAkAgEAgkQgAECQCAQACBKBAABBIhAAIEgEAgDUzMxv1Mo8dMelmVgAAAAASUVORK5CYII=" style="width:100%"></div><div class="mySlides fade">  <img src="data:image/png;base64,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IBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAECa1tr/AOYoBWcHwkZtAAAAAElFTkSuQmCC" style="width:100%"></div><div class="mySlides fade">  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoEAAAHhCAYAAAART2R/AAAACXBIWXMAAAsSAAALEgHS3X78AAARHUlEQVR4nO3d8XHcxqHH8VXG/5OpQHQFZAc6VxCmAlMd0BVIriB0BaYqiFSByApCVhCxA7ICvsGbZUK/Z0m8wwIL3O/zmblxbCc+3MKT+c4udvHq8fGxAACQ5S/uNwBAHhEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABPrBTQf2zFH9bOrP2jz7eW++8VPvSilfnv351bM/3pdSbvyLAuyTV4+Pj24osGabZ5+TUsrBhL/ltsbgVf18ecH/BmCRRCCwRmc1/E4njr7vuasx+LF+AFZDBAJrMczynS8g/L7moYbghaVjYA1EILB0Z/Xzref5lua6lHJZPwCLJAKBpdrUiHq94jt0V2cvLRUDi+OIGGBpTupzdp9XHoClXv8/6+85WcD1APyHCASW5H0p5V8rW/p9iTf1d71f/qUCKSwHA0twUpd+jwPuxm3d3OJ4GaArM4FAb2d1liwhAEv9nTc1BAG6EYFAT8Ps3++Bd+CgPit4toBrAUKJQKCHw7pZ4ufw0f+97h4GmJ13BwNzewrAlOXf7/lH/fsXy71EYB/ZGALMSQB+3VuHSwNzEoHAXATg9/3dwdLAXDwTCMzlQgB+1zATeLTwawT2hAgE5vDeJpAXOTATCMxFBAJTG87De2eUX+zYm0WAOXgmEJjSUT0Y+cAob+1HbxUBpmQmEJjSpQDcmZ3CwKREIDCV4RDkN0Z3Z8PYbVZ67cAKWA4GpmAZuI1rIQhMxUwgMIULAdiE2UBgMiIQaG2Ilr8Z1Wa8WxiYhOVgoLUrzwI2Z6cw0JyZQKCljQCcxOke/iagMzOBQEtLnwW8/spfP1n4M4y39RoBmhGBQCvDLODnhY3mp/oatpv6+ZbD+hs2debtdd9L/38sCQNNiUCglcuFvB/4oe5OvhwZTWd1U8Zxw2sb45f6uwCaEIFAC8O5gP9ewEh+quHWcsbsvL7Lt/dy8SfPBgIt2RgCtLCEOPmlXkfrJdOLukR81/ifuy3nBQJNmQkEWvjS8Rm6hxp/VxN/z2H9jp7Lw54LBJoxEwiMddJ5E8UcATi4r88JPszwXV9jhzDQjAgExjrrOIJvZwrAJzf1+cBeRCDQjAgExur1POCHugN4bhffOG9waiIQaEYEAmMcdVoKvuv8Tt1es4GHnb4X2EMiEBij147V8/qMXi9XnXYLeyUf0IwIBMbosRR8Xd8C0puDm4FVE4HAGD1mApcSX3NuSHnOkjDQhAgEdnXU4S0adwuZBSx1p3CP42JsDgGaEIHArnrEyNKWYG8WcA0AOxGBwK56ROBSZgGfeHsHsFoiENjV3M8D3i4wukQgsFoiENjV0cwjt7RZQIBVE4HAruY+JLrXblyAvSQCgV30eB5QBAI09IPBBHYwPAv3k4EDWC8RCOzi3swcwLpZDgYACCQCAQACiUAAgEAiEGBdPIsJNCECAXY394HZAM2IQIDdzR2Bt+4V0IoIBNjd3Idme1cx0IwIBNjNMAt4MPPY3bhXQCsiEGA3mw7jZlMI0IwIBNiNCARWTQQCbO+wlHI687h9cp+AlkQgwPZOOzwP+NF9Alp69fj4aEABtjPs0n0985j9tZRy7z4BrZgJBNjOeYcA/CAAgdbMBAK83EndnDH3UvBPNoUArZkJBHiZYTPIZYcAvBaAwBREIMD3HdYQO+4wVu/dH2AKIhDg2046BqBZQGAyngkE+HOHdRPIu47j86P3BQNT+cHIAvzB8CaQs05nAT73qwAEpmQmENgXQ7gd7fhbTurM35uFjMVtvSaAyYhAYF9cLSjixnioAWgWEJiUjSEAy3IqAIE5iECA5XhrNzAwFxEIsAxv62HUALMQgQD9CUBgdiIQoJ8HAQj04pxAgD7u6iaQG+MP9GAmEGB+H+oxMAIQ6MZMIMB87uqr6D4ac6A3EQgwveHZv4v6uTfewBKIQIDpiD9gsUQgQHt3dcev+AMWy8YQgPYu65s/BCCwWCIQoL13pZTPNQKHINwYY2BpRCDAdA5KKT/XIPxSSjkz1sBSiECAebwupfwuBoGlEIEA83qKwZt6YDRAFyIQoI/jUsq/SinvjT/QgwgE6Otd3Ul86D4AcxKBAP29qSFoeRiYjQgEWIZjIQjMSQQCLMeBEATmIgIBlmUIwY+eEQSmJgIBlud1nREEmIwIBFim4RnBC/cGmMqrx8dHgwvsg4sRz9Id1dm3JfrJrCAwBREI8F9DDG7q57Q+n9fbXb0ugKZEIMDXndU3evSeJfzVm0WA1kQgwPed1wjrNTP4UGcD790roBUbQwC+7+l5w9tOY3VgkwjQmplAgJc7rJs0jjuMmdlAoCkzgQAvd183jfSYETyoy9IATZgJBNjeMCN30+EZQTuFgWbMBAJs70un3bqv69E1AKOJQIDdDBs1rjuMnQgEmrAcDLC74fnAzzOP30PdoAIwiplAgN1dddgkcjDi9XgA/yECAca57DB+loSB0UQgwDg9InDjngFjiUCAce47LAlbDgZGE4EA413NPIYHzgsExhKBAOPNHYFFBAJjiUCA8b50GEPPBQKjiECA8W46jKGzAoFRRCBAGw8zj6PNIcAoIhCgjR6zgQA7E4EA62RjCDCKCARYp9fuGzCGCAQACCQCAQACiUAAgEAiEAAgkAgEAAgkAgEAAolAAIBAP7jpwBY2Mw/W8BaOezcIoL1Xj4+PhhV4qbn/D+NtKeVyJXfnS4cDnF/N/H3AHrEcDGzjdubROlnR3fEGD2BVRCCwjbmXZtcSgWuKVYD/JQKBbdzMPFpvSimHK7hDPSLwrsN3AntEBALb6LFJ43QFd2juDTOlPoMIsDMRCGzjqsNorSEC13CNAH8gAoFtzL0cPPhbKeVowXdpCMCDDt/b414Ae0QEAtu47/Qs2tmC79J5p+91fiIwiggEttVjBup8obOBm7p5pQczgcAoIhDYVo/nAofl1osF3qn3Hb/bxhBgFBEIbKtHBJb6bOCSloXPO84CFjOBwFheGwfsoscr0gYPdQm2dwAN1/C54/ffOqAaGMtMILCLj51G7aDORPYMoJOOv/9Jr9lYYI+IQGAXPSPoKQR7nM23qd/d40iY5ywFA6OJQGAXV51fWzZE2D9n3pjxvi4B9w7AYiYQaEEEArvqvSQ6eFefT5xyw8imfse7Cb9jG7d2BgMtiEBgV0s5smXYoPJ7DaNhx+5hg3/mYQ3Lmzr712MTzNdcLuhagBWzOxgY42M9umVpbuu13dTP92bOjupn0/kA6Jf40Uwg0IIIBMbofVTKtq7/z39/ybH3ZxwNAzQjAoGxrlYYU2v11nIw0IoIBMZa22zgWj3UJev79IEA2rAxBBjr6k+WWWnvQgACLZkJBFoYZqj+bSQnYxYQaM5MINDCsFv1VyM5GbOAQHNmAoGWhuNYjo1oU2YBgUmYCQRamvLNHanOBSAwBREItDTMBP5iRJu5diQMMBXLwcAUhnD52ciO8lAPhvZ2EGASZgKBKZzXt1uwuzMBCExJBAJTuK+HSAvB3fxW330MMBnLwcCUjupzggdG+cU+2GADzEEEAlM7qbNar430d93W8QKYnOVgYGo3NWwsDX/bbV1CB5iFCATm8PSMoHcM/7kPdXycBwjMRgQCc3kKwd+M+B/8Vp8BFIDArDwTCPSwqc8JJm8YeahH6TgMGujCTCDQw1XdOfwpdPSv63OSAhDoRgQCvQzLn6ellJ9KKXchd+GhvlZv4yBooDcRCPT2NCv4ds9j8EP9nRcLuBYAEQgsxuWexuAQfz/a/AEsjY0hwFKd1c+bFd6hhxq1F5Z9gaUSgcDSHT0LwqW/deRT3fVswweweCIQWJOjupnkdCEzhHf1mcarGn+We4HVEIHAmm3qUSubGojHE/+W6/oavJsafpZ6gdUSgcC+GaLw8Nkfn/7zS93XyCs18r7UPzfLB+wVEQgAEMgRMQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAIBEIABBIBAIABBKBAACBRCAAQCARCAAQSAQCAAQSgQAAgUQgAEAgEQgAEEgEAgAEEoEAAIFEIABAmlLK/wC9eRIXvohjYwAAAABJRU5ErkJggg==" style="width:100%"></div><div id = "progress-bar-container"><div id = "progress-bar"></div></div></div>',document.body.appendChild(splash);scriptEl=document.createElement("script"),scriptEl.innerHTML='let slideIndex = 1;showSlides(slideIndex);function ready(callback){    if (document.readyState!="loading") callback();    else if (document.addEventListener) document.addEventListener("DOMContentLoaded", callback);    else document.attachEvent("onreadystatechange", function(){        if (document.readyState=="complete") callback();    });}var timer = setInterval(function(){plusSlides(1)}, 5000);ready(function(){   timer});function plusSlides(n) {  showSlides(slideIndex += n);}function currentSlide(n) {  showSlides(slideIndex = n);}function showSlides(n) {  let i;  let slides = document.getElementsByClassName("mySlides");  if (n > slides.length) {slideIndex = 1}      if (n < 1) {slideIndex = slides.length}  for (i = 0; i < slides.length; i++) {    slides[i].style.display = "none";    }  slides[slideIndex-1].style.display = "block";  }',splash.appendChild(scriptEl)}(),A.on("preload:end",(function(){A.off("preload:progress")})),A.on("preload:progress",(function(A){var E=document.getElementById("progress-bar");E&&(A=Math.min(1,Math.max(0,A)),E.style.width=100*A+"%")})),A.on("start",(function(){var A=document.getElementById("splash");A.parentElement.removeChild(A),clearInterval(timer)}))}));var RenderLayerTotexture=pc.createScript("renderLayerTotexture");RenderLayerTotexture.attributes.add("layerName",{type:"string"}),RenderLayerTotexture.prototype.initialize=function(){var e=new pc.Texture(this.app.graphicsDevice,{width:1024,height:1024,format:pc.PIXELFORMAT_R8_G8_B8_A8,autoMipmap:!0});e.minFilter=pc.FILTER_LINEAR,e.magFilter=pc.FILTER_LINEAR;var r=new pc.RenderTarget(this.app.graphicsDevice,e,{depth:!0});console.log(this.app.xr),this.app.scene.layers.getLayerByName(this.layerName).renderTarget=r};var KeyboardInputFly=pc.createScript("KeyboardInputFly");KeyboardInputFly.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera},KeyboardInputFly.prototype.postInitialize=function(){this.orbitCamera&&(this.startDistance=this.orbitCamera.distance,this.startYaw=this.orbitCamera.yaw,this.startPitch=this.orbitCamera.pitch,this.startPivotPosition=this.orbitCamera.pivotPoint.clone())},KeyboardInputFly.prototype.update=function(t){this.orbitCamera&&this.app.keyboard.wasPressed(pc.KEY_BACKSPACE)&&(this.orbitCamera.reset(this.startYaw,this.startPitch,this.startDistance),this.orbitCamera.pivotPoint=this.startPivotPosition)};pc.extend(pc,function(){function computeGaussian(e,t){return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-e*e/(2*t*t))}function calculateBlurValues(e,t,s,o,r){e[0]=computeGaussian(0,r),t[0]=0,t[1]=0;var i,a,l=e[0];for(i=0,a=Math.floor(7.5);i<a;i++){var u=computeGaussian(i+1,r);e[2*i]=u,e[2*i+1]=u,l+=2*u;var h=2*i+1.5;t[4*i]=s*h,t[4*i+1]=o*h,t[4*i+2]=-s*h,t[4*i+3]=-o*h}for(i=0,a=e.length;i<a;i++)e[i]/=l}var BloomEffect=function(e){var t={aPosition:pc.SEMANTIC_POSITION},s=["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition + 1.0) * 0.5;","}"].join("\n"),o=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform sampler2D uBaseTexture;","uniform float uBloomThreshold;","","void main(void)","{","    vec4 color = texture2D(uBaseTexture, vUv0);","","    gl_FragColor = clamp((color - uBloomThreshold) / (1.0 - uBloomThreshold), 0.0, 1.0);","}"].join("\n"),r=["precision "+e.precision+" float;","","#define SAMPLE_COUNT 15","","varying vec2 vUv0;","","uniform sampler2D uBloomTexture;","uniform vec2 uBlurOffsets[SAMPLE_COUNT];","uniform float uBlurWeights[SAMPLE_COUNT];","","void main(void)","{","    vec4 color = vec4(0.0);","    for (int i = 0; i < SAMPLE_COUNT; i++)","    {","        color += texture2D(uBloomTexture, vUv0 + uBlurOffsets[i]) * uBlurWeights[i];","    }","","    gl_FragColor = color;","}"].join("\n"),i=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform float uBloomEffectIntensity;","uniform sampler2D uBaseTexture;","uniform sampler2D uBloomTexture;","","void main(void)","{","    vec4 bloom = texture2D(uBloomTexture, vUv0) * uBloomEffectIntensity;","    vec4 base = texture2D(uBaseTexture, vUv0);","","    base *= (1.0 - clamp(bloom, 0.0, 1.0));","","    gl_FragColor = base + bloom;","}"].join("\n");this.extractShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:o}),this.blurShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:r}),this.combineShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:i});var a=e.width,l=e.height;this.targets=[];for(var u=0;u<2;u++){var h=new pc.Texture(e,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:a>>1,height:l>>1});h.minFilter=pc.FILTER_LINEAR,h.magFilter=pc.FILTER_LINEAR,h.addressU=pc.ADDRESS_CLAMP_TO_EDGE,h.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var n=new pc.RenderTarget(e,h,{depth:!1});this.targets.push(n)}this.bloomThreshold=.25,this.blurAmount=4,this.bloomIntensity=1.25,this.sampleWeights=new Float32Array(15),this.sampleOffsets=new Float32Array(30)};return(BloomEffect=pc.inherits(BloomEffect,pc.PostEffect)).prototype=pc.extend(BloomEffect.prototype,{render:function(e,t,s){var o=this.device,r=o.scope;r.resolve("uBloomThreshold").setValue(this.bloomThreshold),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.extractShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,1/this.targets[1].width,0,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),pc.drawFullscreenQuad(o,this.targets[1],this.vertexBuffer,this.blurShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,0,1/this.targets[0].height,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[1].colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.blurShader),r.resolve("uBloomEffectIntensity").setValue(this.bloomIntensity),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,t,this.vertexBuffer,this.combineShader,s)}}),{BloomEffect:BloomEffect}}());var Bloom=pc.createScript("bloom");Bloom.attributes.add("bloomIntensity",{type:"number",default:1,min:0,title:"Intensity"}),Bloom.attributes.add("bloomThreshold",{type:"number",default:.25,min:0,max:1,precision:2,title:"Threshold"}),Bloom.attributes.add("blurAmount",{type:"number",default:4,min:1,title:"Blur amount"}),Bloom.prototype.initialize=function(){this.effect=new pc.BloomEffect(this.app.graphicsDevice),this.effect.bloomThreshold=this.bloomThreshold,this.effect.blurAmount=this.blurAmount,this.effect.bloomIntensity=this.bloomIntensity;var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("attr",(function(e,t){this.effect[e]=t}),this),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};var CharacterController=pc.createScript("characterController");CharacterController.attributes.add("speed",{type:"number",default:5}),CharacterController.attributes.add("jumpImpulse",{type:"number",default:400}),CharacterController.prototype.initialize=function(){this.groundCheckRay=new pc.Vec3(0,-1.1,0),this.rayEnd=new pc.Vec3,this.groundNormal=new pc.Vec3,this.onGround=!0,this.jumping=!1},CharacterController.prototype.move=function(t){if(this.onGround&&!this.jumping){var e=new pc.Vec3,i=t.length();i>0&&(e.cross(this.groundNormal,t).cross(e,this.groundNormal),e.normalize().scale(i*this.speed)),this.entity.rigidbody.linearVelocity=e}},CharacterController.prototype.jump=function(){this.onGround&&!this.jumping&&(this.entity.rigidbody.applyImpulse(0,this.jumpImpulse,0),this.onGround=!1,this.jumping=!0,setTimeout(function(){this.jumping=!1}.bind(this),500))},CharacterController.prototype.update=function(t){var e=this.entity.getPosition();this.rayEnd.add2(e,this.groundCheckRay);var i=this.app.systems.rigidbody.raycastFirstByTag(e,this.rayEnd,"Physical");this.onGround=!!i,i&&this.groundNormal.copy(i.normal)};var FirstPersonCamera=pc.createScript("firstPersonCamera");FirstPersonCamera.attributes.add("camera",{title:"Camera",description:"The camera controlled by this first person view. It should be a child of the entity to which this script is assigned. If no camera is assigned, the script will create one for you.",type:"entity"}),FirstPersonCamera.prototype.initialize=function(){var t=this.app;this.camera||(this.camera=this.entity.findByName("Camera"),this.camera||(this.camera=new pc.Entity("FPS Camera"),this.camera.addComponent("camera"))),this.x=new pc.Vec3,this.z=new pc.Vec3,this.heading=new pc.Vec3,this.magnitude=new pc.Vec2,this.azimuth=0,this.elevation=0;var e=this.camera.forward.clone();e.y=0,e.normalize(),this.azimuth=Math.atan2(-e.x,-e.z)*(180/Math.PI),(new pc.Mat4).setFromAxisAngle(pc.Vec3.UP,-this.azimuth).transformVector(this.camera.forward,e),this.elevation=Math.atan(e.y,e.z)*(180/Math.PI),this.forward=0,this.strafe=0,this.jump=!1,this.cnt=0,t.on("firstperson:forward",(function(t){this.forward=t}),this),t.on("firstperson:strafe",(function(t){this.strafe=t}),this),t.on("firstperson:look",(function(t,e){this.azimuth+=t,this.elevation+=e,this.elevation=pc.math.clamp(this.elevation,-90,90)}),this),t.on("firstperson:jump",(function(){this.jump=!0}),this)},FirstPersonCamera.prototype.postUpdate=function(t){this.camera.setEulerAngles(this.elevation,this.azimuth,0),this.z.copy(this.camera.forward),this.z.y=0,this.z.normalize(),this.x.copy(this.camera.right),this.x.y=0,this.x.normalize(),this.heading.set(0,0,0),0!==this.forward&&(this.z.scale(this.forward),this.heading.add(this.z)),0!==this.strafe&&(this.x.scale(this.strafe),this.heading.add(this.x)),this.heading.length()>1e-4&&(this.magnitude.set(this.forward,this.strafe),this.heading.normalize().scale(this.magnitude.length())),this.jump&&(this.entity.script.characterController.jump(),this.jump=!1),this.entity.script.characterController.move(this.heading);var e=this.camera.getPosition();this.app.fire("cameramove",e)};var KeyboardInput=pc.createScript("keyboardInput");KeyboardInput.prototype.initialize=function(){var t=this.app,updateMovement=function(e,i){switch(e){case 38:case 87:t.fire("firstperson:forward",i);break;case 40:case 83:t.fire("firstperson:forward",-i);break;case 37:case 65:t.fire("firstperson:strafe",-i);break;case 39:case 68:t.fire("firstperson:strafe",i)}},keyDown=function(e){e.repeat||(updateMovement(e.keyCode,1),32===e.keyCode&&t.fire("firstperson:jump"))},keyUp=function(t){updateMovement(t.keyCode,0)},addEventListeners=function(){window.addEventListener("keydown",keyDown,!0),window.addEventListener("keyup",keyUp,!0)};this.on("enable",addEventListeners),this.on("disable",(function(){window.addEventListener("keydown",keyDown,!0),window.addEventListener("keyup",keyUp,!0)})),addEventListeners()};var MouseInput=pc.createScript("mouseInput");function applyRadialDeadZone(t,e,i,s){var a=t.length();if(a>i){var r=1-s-i,n=Math.min(1,(a-i)/r)/a;e.copy(t).scale(n)}else e.set(0,0)}MouseInput.attributes.add("camera",{type:"entity",description:"Optional, assign a camera entity, otherwise one is created"}),MouseInput.attributes.add("lookSpeed",{type:"number",default:.25,description:"Adjusts the sensitivity of looking"}),MouseInput.prototype.initialize=function(){this.force=new pc.Vec3,this.eulers=new pc.Vec3,this.on("enable",this.onEnable,this),this.on("disable",this.onDisable,this),this.onEnable()},MouseInput.prototype.onEnable=function(){this.app.mouse.on("mousemove",this._onMouseMove,this)},MouseInput.prototype.onDisable=function(){this.app.mouse.off("mousemove",this._onMouseMove,this)},MouseInput.prototype.update=function(t){this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0)},MouseInput.prototype._onMouseMove=function(t){if(pc.Mouse.isPointerLocked()||t.buttons[0]){var e=t.dx,i=t.dy;this.app.fire("firstperson:look",-e/5,-i/5)}};var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("deadZone",{title:"Dead Zone",description:"Radial thickness of inner dead zone of the virtual joysticks. This dead zone ensures the virtual joysticks report a value of 0 even if a touch deviates a small amount from the initial touch.",type:"number",min:0,max:.4,default:.3}),TouchInput.attributes.add("turnSpeed",{title:"Turn Speed",description:"Maximum turn speed in degrees per second",type:"number",default:150}),TouchInput.attributes.add("radius",{title:"Radius",description:"The radius of the virtual joystick in CSS pixels.",type:"number",default:50}),TouchInput.attributes.add("doubleTapInterval",{title:"Double Tap Interval",description:"The time in milliseconds between two taps of the right virtual joystick for a double tap to register. A double tap will trigger a jump.",type:"number",default:300}),TouchInput.prototype.initialize=function(){var t=this.app,e=t.graphicsDevice,i=e.canvas;this.remappedPos=new pc.Vec2,this.leftStick={identifier:-1,center:new pc.Vec2,pos:new pc.Vec2},this.rightStick={identifier:-1,center:new pc.Vec2,pos:new pc.Vec2},this.lastRightTap=0;var s=function(s){s.preventDefault();for(var a=e.width/i.clientWidth,r=e.height/i.clientHeight,n=s.changedTouches,o=0;o<n.length;o++){var h=n[o];if(h.pageX<=i.clientWidth/2&&-1===this.leftStick.identifier)this.leftStick.identifier=h.identifier,this.leftStick.center.set(h.pageX,h.pageY),this.leftStick.pos.set(0,0),t.fire("leftjoystick:enable",h.pageX*a,h.pageY*r);else if(h.pageX>i.clientWidth/2&&-1===this.rightStick.identifier){this.rightStick.identifier=h.identifier,this.rightStick.center.set(h.pageX,h.pageY),this.rightStick.pos.set(0,0),t.fire("rightjoystick:enable",h.pageX*a,h.pageY*r);var p=Date.now();p-this.lastRightTap<this.doubleTapInterval&&t.fire("firstperson:jump"),this.lastRightTap=p}}}.bind(this),a=function(s){s.preventDefault();for(var a=e.width/i.clientWidth,r=e.height/i.clientHeight,n=s.changedTouches,o=0;o<n.length;o++){var h=n[o];h.identifier===this.leftStick.identifier?(this.leftStick.pos.set(h.pageX,h.pageY),this.leftStick.pos.sub(this.leftStick.center),this.leftStick.pos.scale(1/this.radius),t.fire("leftjoystick:move",h.pageX*a,h.pageY*r)):h.identifier===this.rightStick.identifier&&(this.rightStick.pos.set(h.pageX,h.pageY),this.rightStick.pos.sub(this.rightStick.center),this.rightStick.pos.scale(1/this.radius),t.fire("rightjoystick:move",h.pageX*a,h.pageY*r))}}.bind(this),r=function(e){e.preventDefault();for(var i=e.changedTouches,s=0;s<i.length;s++){var a=i[s];a.identifier===this.leftStick.identifier?(this.leftStick.identifier=-1,t.fire("firstperson:forward",0),t.fire("firstperson:strafe",0),t.fire("leftjoystick:disable")):a.identifier===this.rightStick.identifier&&(this.rightStick.identifier=-1,t.fire("rightjoystick:disable"))}}.bind(this),addEventListeners=function(){i.addEventListener("touchstart",s,!1),i.addEventListener("touchmove",a,!1),i.addEventListener("touchend",r,!1)};this.on("enable",addEventListeners),this.on("disable",(function(){i.removeEventListener("touchstart",s,!1),i.removeEventListener("touchmove",a,!1),i.removeEventListener("touchend",r,!1)})),addEventListeners()},TouchInput.prototype.update=function(t){var e=this.app;if(-1!==this.leftStick.identifier){applyRadialDeadZone(this.leftStick.pos,this.remappedPos,this.deadZone,0);var i=this.remappedPos.x;this.lastStrafe!==i&&(e.fire("firstperson:strafe",i),this.lastStrafe=i);var s=-this.remappedPos.y;this.lastForward!==s&&(e.fire("firstperson:forward",s),this.lastForward=s)}if(-1!==this.rightStick.identifier){applyRadialDeadZone(this.rightStick.pos,this.remappedPos,this.deadZone,0);var a=-this.remappedPos.x*this.turnSpeed*t,r=-this.remappedPos.y*this.turnSpeed*t;e.fire("firstperson:look",a,r)}};var GamePadInput=pc.createScript("gamePadInput");GamePadInput.attributes.add("deadZoneLow",{title:"Low Dead Zone",description:"Radial thickness of inner dead zone of pad's joysticks. This dead zone ensures that all pads report a value of 0 for each joystick axis when untouched.",type:"number",min:0,max:.4,default:.2}),GamePadInput.attributes.add("deadZoneHigh",{title:"High Dead Zone",description:"Radial thickness of outer dead zone of pad's joysticks. This dead zone ensures that all pads can reach the -1 and 1 limits of each joystick axis.",type:"number",min:0,max:.4,default:.2}),GamePadInput.attributes.add("turnSpeed",{title:"Turn Speed",description:"Maximum turn speed in degrees per second",type:"number",default:150}),GamePadInput.prototype.initialize=function(){this.lastStrafe=0,this.lastForward=0,this.lastJump=!1,this.remappedPos=new pc.Vec2,this.leftStick={center:new pc.Vec2,pos:new pc.Vec2},this.rightStick={center:new pc.Vec2,pos:new pc.Vec2};var addEventListeners=function(){window.addEventListener("gamepadconnected",(function(t){})),window.addEventListener("gamepaddisconnected",(function(t){}))};this.on("enable",addEventListeners),this.on("disable",(function(){window.removeEventListener("gamepadconnected",(function(t){})),window.removeEventListener("gamepaddisconnected",(function(t){}))})),addEventListeners()},GamePadInput.prototype.update=function(t){for(var e=this.app,i=navigator.getGamepads?navigator.getGamepads():[],s=0;s<i.length;s++){var a=i[s];if(a&&"standard"===a.mapping&&a.axes.length>=4){this.leftStick.pos.set(a.axes[0],a.axes[1]),applyRadialDeadZone(this.leftStick.pos,this.remappedPos,this.deadZoneLow,this.deadZoneHigh);var r=this.remappedPos.x;this.lastStrafe!==r&&(e.fire("firstperson:strafe",r),this.lastStrafe=r);var n=-this.remappedPos.y;this.lastForward!==n&&(e.fire("firstperson:forward",n),this.lastForward=n),this.rightStick.pos.set(a.axes[2],a.axes[3]),applyRadialDeadZone(this.rightStick.pos,this.remappedPos,this.deadZoneLow,this.deadZoneHigh);var o=-this.remappedPos.x*this.turnSpeed*t,h=-this.remappedPos.y*this.turnSpeed*t;e.fire("firstperson:look",o,h),a.buttons[0].pressed&&!this.lastJump&&e.fire("firstperson:jump"),this.lastJump=a.buttons[0].pressed}}};var ApplyTexture=pc.createScript("applyTexture");ApplyTexture.attributes.add("layerName",{type:"string"}),ApplyTexture.attributes.add("multiply_alpha",{type:"boolean"}),ApplyTexture.prototype.postInitialize=function(){var e=this.app.scene.layers.getLayerByName(this.layerName),t=this.entity.model.model.meshInstances[0].material;t.diffuseMap=e.renderTarget.colorBuffer,t.opacityMap=e.renderTarget.colorBuffer,t.emissiveMap=e.renderTarget.colorBuffer,t.opacityMapChannel="a",1==this.multiply_alpha?t.blendType=pc.BLEND_MULTIPLICATIVE:t.blendType=pc.BLEND_NORMAL,t.update()},ApplyTexture.prototype.update=function(e){};var GlbAddAnim_gagu=pc.createScript("glbAddAnim_gagu");GlbAddAnim_gagu.attributes.add("glbAsset",{type:"asset",assetType:"binary"}),GlbAddAnim_gagu.prototype.initialize=function(){this.state=0,this.state_fit=0;var e=this;utils.loadGlbContainerFromAsset(this.glbAsset,null,this.glbAsset.name,(function(t,i){currentlayer=[];var a=i.resource.instantiateRenderEntity();e.entity.addChild(a),a.addComponent("anim",{activate:!0});for(let e=0;e<i.resource.animations.length;e++)currentlayer[e]=a.anim.addLayer("Animation "+e,1,null,"ADDITIVE"),a.anim.assignAnimation("Animation "+e,i.resource.animations[e].resource,"Animation "+e,1,!1);assignChildColRigid=function(t){achild=t._children;for(let t=0;t<achild.length;t++)if(null!=achild[t].render){var i=achild[t].render._meshInstances[0].material.name,a=i.split(".")[0]+e.tag,n=e.app.assets.find(a,"texture");if(n){var s=n.resource;material=achild[t].render._meshInstances[0].material,material.name=i,material.diffuseMap=s,material.opacityMap=s,emissiveOn&&(material.emissiveMap=s),material._useSkybox=!1,material._useLighting=!1,material._useFog=!1,material.update(),e.objectlist.push(material)}achild[t].render._meshInstances[0].material._emissiveIntensity=0,achild[t].render._meshInstances[0].material._metalness=0}0!=t._children.length&&callGroup(t._children)},callGroup=function(e){for(let t=0;t<e.length;t++)assignChildColRigid(e[t])},assignChildColRigid(a)}))},GlbAddAnim_gagu.prototype.update=function(e){if(this.scene=this.entity.children[0],this.state=state,console.log(this.state),0==this.state?this.count<1?this.count+=2*e:this.count=1:this.count>0?this.count-=2*e:this.count=0,null!=this.scene){this.scene.anim.speed=this.count;var t=this.scene;this.app.on("glb reset",(function(){if(null!=t){this.currentlayer=t.anim.layers;for(let e=0;e<this.currentlayer.length;e++)t.anim.baseLayer.reset(),t.anim.baseLayer.play(),this.currentlayer[e].reset(),this.currentlayer[e].play()}}))}};var ShowMap=pc.createScript("showMap");ShowMap.prototype.initialize=function(){this.entity.button.on("click",(function(){this.doSomething()}),this)},ShowMap.prototype.doSomething=function(){this.app.fire("map_Start")};var CameraMovesWheel=pc.createScript("cameraMovesWheel");CameraMovesWheel.attributes.add("lerpSmoothness",{type:"number",default:2,title:"CameraMoveStiffness"}),CameraMovesWheel.attributes.add("wheelChangeMultiplier",{type:"number",default:10,title:"CameraSpeed"}),CameraMovesWheel.prototype.initialize=function(){var e=this.app.mouse;this._mouseWheelChange=0,this.alpha=0,this.frame=0,this.movestate=0,this.active=1,e.on(pc.EVENT_MOUSEWHEEL,(function(e){this._mouseWheelChange=e.wheelDelta}),this),this.app.on("cameramove_stopClock",(function(e){this.active=0})),this.app.on("cameramove_startClock",(function(e){this.active=1}))},CameraMovesWheel.prototype.update=function(t){0==this.active&&(this._mouseWheelChange=0),this.alpha+=this.lerpSmoothness*t,this.alpha>1&&(this.alpha=1),0!=this._mouseWheelChange&&(this.movestate=this._mouseWheelChange*this.wheelChangeMultiplier,this.alpha=0),this.frame+=pc.math.lerp(this.movestate*t,0,this.alpha),this.app.fire("cameramove_frame",e=this.frame),this._mouseWheelChange=0};var RecieverCamera=pc.createScript("recieverCamera");RecieverCamera.prototype.initialize=function(){this.entity.findByName("Armature").anim._speed=0,this.animtime=0,this.app.on("cameramove_frame",(function(e){this.animtime=e}),this)},RecieverCamera.prototype.update=function(e){console.log(this.entity.findByName("Armature").anim.baseLayer.activeStateCurrentTime),this.entity.findByName("Armature").anim.baseLayer.activeStateCurrentTime=this.animtime};var TextInput=pc.createScript("textInput");TextInput.prototype.initialize=function(){let t=this;t.inputElement=document.createElement("input"),t.inputElement.style.position="fixed",t.inputElement.style.top="50%",t.inputElement.style.left="20%",document.body.appendChild(t.inputElement),t.entity.element.on(pc.EVENT_MOUSEDOWN,(()=>{window.setTimeout((()=>{t.inputElement.focus()}),100)}))},TextInput.prototype.update=function(t){this.entity.children[0].element.text=this.inputElement.value};var PhaseMover=pc.createScript("phaseMover");PhaseMover.attributes.add("phase",{type:"number",title:"change phase",default:1}),PhaseMover.prototype.initialize=function(){this.last=0},PhaseMover.prototype.update=function(t){this.phase!=this.last&&this.app.fire("PhaseMover:phase",e=this.phase),this.last=this.phase};var SkyMapChanger=pc.createScript("skyMapChanger");SkyMapChanger.attributes.add("zerocube_W",{type:"asset",assetType:"cubemap",array:!0,title:"default skybox"}),SkyMapChanger.attributes.add("zerocube_L",{type:"asset",assetType:"cubemap",array:!0,title:"default left skybox"}),SkyMapChanger.attributes.add("zerocube_R",{type:"asset",assetType:"cubemap",array:!0,title:"default right skybox"}),SkyMapChanger.prototype.initialize=function(){this.left=this.entity.findByName("Left").render._meshInstances[0].material,this.right=this.entity.findByName("Right").render._meshInstances[0].material,console.log(this.left),console.log(this.zerocube_W),this.app.on("PhaseMover:phase",(function(e){console.log(e),e>=1&e<=2?(this.left.cubeMap=this.zerocube_L[1].resource,this.right.cubeMap=this.zerocube_R[1].resource,this.sky=this.zerocube_W[1]):e>=2&e<=3?(this.left.cubeMap=this.zerocube_L[2].resource,this.right.cubeMap=this.zerocube_R[2].resource,this.sky=this.zerocube_W[2]):e>=3&e<=4?(this.left.cubeMap=this.zerocube_L[3].resource,this.right.cubeMap=this.zerocube_R[3].resource,this.sky=this.zerocube_W[3]):e>=4&e<=5?(this.left.cubeMap=this.zerocube_L[4].resource,this.right.cubeMap=this.zerocube_R[4].resource,this.sky=this.zerocube_W[4]):(this.left.cubeMap=this.zerocube_L[0].resource,this.right.cubeMap=this.zerocube_R[0].resource,this.sky=this.zerocube_W[0]),0===this.app.scene.skyboxMip&&(this.sky.loadFaces=!0,this.app.assets.load(this.sky)),this.app.scene.setSkybox(this.sky.resources),console.log(this.left),this.left.update(),this.right.update()}),this)},SkyMapChanger.prototype.update=function(e){};function NoiseTEffect(e){pc.PostEffect.call(this,e),this.shader=new pc.Shader(e,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:["precision "+e.precision+" float;","","uniform sampler2D uColorBuffer;","varying vec2 vUv0;","uniform vec2 uResolution;","uniform float iTime;","float filmGrainNoise(in float iTime, in vec2 uv)","{","    return fract(sin(dot(uv, vec2(12.9898, 78.233) * iTime)) * 43543.5453);","}","void main(void)","{","    vec2 uv = gl_FragCoord.xy / uResolution.xy;","    vec3 pixelColor = texture2D(uColorBuffer, uv).rgb;;","    float grainFactor = filmGrainNoise(iTime, uv);","    pixelColor = mix(pixelColor, vec3(0.0), grainFactor * 0.4);","    gl_FragColor = vec4(pixelColor, 1.0);","}"].join("\n")}),this.resolution=new Float32Array(2)}NoiseTEffect.prototype=Object.create(pc.PostEffect.prototype),NoiseTEffect.prototype.constructor=NoiseTEffect,Object.assign(NoiseTEffect.prototype,{render:function(e,t,i){var o=this.device,f=o.scope;this.resolution[0]=1/e.width,this.resolution[1]=1/e.height,f.resolve("uResolution").setValue(this.resolution),f.resolve("uColorBuffer").setValue(e.colorBuffer),f.resolve("iTime").setValue(this.time),pc.drawFullscreenQuad(o,t,this.vertexBuffer,this.shader,i)}});var NoiseEffect=pc.createScript("noiseEffect");NoiseEffect.prototype.initialize=function(){this.effect=new NoiseTEffect(this.app.graphicsDevice),this.time=0,this.effect.time=this.time,this.on("attr",(function(e,t){this.effect[e]=t}),this);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))},NoiseEffect.prototype.update=function(e){this.time+=e,this.effect.time=this.time};var PhaseChanger=pc.createScript("phaseChanger");PhaseChanger.prototype.initialize=function(){this.first=this.entity.findByName("FirstFrame"),this.second=this.entity.findByName("SecondFrame"),this.third=this.entity.findByName("ThirdFrame"),this.fourth=this.entity.findByName("FourthFrame"),this.target=0,this.app.on("PhaseMover:phase",(function(t){console.log(t),this.extarget=this.target,t>=1&t<=2?(this.first.enabled=!0,this.second.enabled=!1,this.third.enabled=!1,this.fourth.enabled=!1,this.target=this.first):t>=2&t<=3?(this.first.enabled=!1,this.second.enabled=!0,this.third.enabled=!1,this.fourth.enabled=!1,this.target=this.second):t>=3&t<=4?(this.first.enabled=!1,this.second.enabled=!1,this.third.enabled=!0,this.fourth.enabled=!1,this.target=this.third):t>=4&t<=5?(this.first.enabled=!1,this.second.enabled=!1,this.third.enabled=!1,this.fourth.enabled=!0,this.target=this.fourth):(this.first.enabled=!1,this.second.enabled=!1,this.third.enabled=!1,this.fourth.enabled=!1,this.target=0),this.target!=this.extarget&0!=this.target&&(this.time=0,this.title=this.target.findByName("Title"),this.texts=this.target.findByName("Text"),this.image=this.target.findByName("Image"),this.bodytext=this.target.findByName("BodyText"))}),this)},PhaseChanger.prototype.update=function(t){this.time+=t/4,this.time>=2&&(this.time=2,this.target.enabled=!1),this.opacity=1-Math.pow(this.time-1,2),0!=this.target&&(this.title.element.opacity=this.opacity,this.texts.element.opacity=this.opacity,this.image.element.opacity=this.opacity,this.bodytext.element.opacity=this.opacity)};var GlbAddAnim_Image=pc.createScript("glbAddAnim_Image");GlbAddAnim_Image.attributes.add("glbAsset",{type:"asset",assetType:"binary"}),GlbAddAnim_Image.attributes.add("timelimit",{type:"number",default:30,title:"timelimit"}),GlbAddAnim_Image.attributes.add("emitfreq",{type:"number",default:.7,title:"emissionfrequency"}),GlbAddAnim_Image.attributes.add("emitstr",{type:"number",default:1,title:"emission strength"}),GlbAddAnim_Image.attributes.add("emitfreq_h",{type:"number",default:1,title:"emission frequency on hover"}),GlbAddAnim_Image.attributes.add("emitstr_h",{type:"number",default:2,title:"emission strength on hover"}),GlbAddAnim_Image.attributes.add("tag",{type:"string",default:".png",title:"tag"}),GlbAddAnim_Image.attributes.add("collisionOn",{type:"boolean",default:!1,title:"CollisionOn",description:"defines if collision will be on or not"}),GlbAddAnim_Image.attributes.add("emissiveOn",{type:"boolean",default:!1,title:"emissiveOn",description:"defines if emission will be on or not"}),GlbAddAnim_Image.prototype.initialize=function(){this.state=0,this.animtime=0,this.state_fit=0;var e=this;this.objectlist=[],this.clicked=0,this.hovered=0,this.time=0;var i=this.collisionOn,t=this.emissiveOn;utils.loadGlbContainerFromAsset(this.glbAsset,null,this.glbAsset.name,(function(s,a){currentlayer=[];var n=a.resource.instantiateRenderEntity();e.entity.addChild(n),n.addComponent("anim",{activate:!0}),n.anim.speed=0;for(let e=0;e<a.resource.animations.length;e++)currentlayer[e]=n.anim.addLayer("Animation "+e,1,null,"ADDITIVE"),n.anim.assignAnimation("Animation "+e,a.resource.animations[e].resource,"Animation "+e,1,!1);assignChildColRigid=function(s){achild=s._children;for(let s=0;s<achild.length;s++)if(null!=achild[s].render){var a=achild[s].render._meshInstances[0].material.name,n=a.split(".")[0]+e.tag,l=e.app.assets.find(n,"texture");if(l){var r=l.resource;material=achild[s].render._meshInstances[0].material,material.name=a,material.diffuseMap=r,material.opacityMap=r,t&&(material.emissiveMap=r),material._useSkybox=!1,material._useLighting=!1,material._useFog=!1,material.update(),e.objectlist.push(material)}i&&(achild[s].addComponent("collision",{type:"mesh"}),achild[s].collision.renderAsset=achild[s].render.asset),t&&(achild[s].render._meshInstances[0].material._emissive.r=1,achild[s].render._meshInstances[0].material._emissive.g=1,achild[s].render._meshInstances[0].material._emissive.b=1,achild[s].render._meshInstances[0].material._emissiveIntensity=0)}0!=s._children.length&&callGroup(s._children)},callGroup=function(e){for(let i=0;i<e.length;i++)assignChildColRigid(e[i])},assignChildColRigid(n)})),this.app.on("cameramove_frame",(function(e){this.animtime=e}),this),this.app.on("OnHover:fired",(function(e){this.hovered=null!=e?e.render._meshInstances[0].material:null}),this)},GlbAddAnim_Image.prototype.update=function(e){if(this.scene=this.entity.children[0],this.enableclick+=e,this.time+=e,this.emissiveOn&&(this.nowemit=Math.abs(Math.sin(this.time*this.emitfreq)*this.emitstr),this.nowemit_h=Math.abs(Math.sin(this.time*this.emitfreq_h)*this.emitstr_h),this.nowemit_c=Math.abs(Math.sin(this.enableclick*this.emitfreq_c)*this.emitstr_c)),null!=this.scene&this.animtime<this.timelimit){this.scene.anim.baseLayer.activeStateCurrentTime=this.animtime,this.currentlayer=this.scene.anim.layers;for(let e=0;e<this.currentlayer.length;e++)this.currentlayer[e].activeStateCurrentTime=this.animtime;for(let e of this.objectlist)this.emissiveOn&&(e==this.hovered?e._emissiveIntensity=this.nowemit_h:e._emissiveIntensity=this.nowemit,e.update())}};